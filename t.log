commit 7f1bacc7dc9caf6d0ec042e39499bbf1d9a7d065
Author: Balaji Veeramani <bveeramani@berkeley.edu>
Date:   Sat Jan 29 18:41:57 2022 -0800

    [CI] Format Python code with Black (#21975)
    
    See #21316 and #21311 for the motivation behind these changes.

 .buildkite/copy_files.py                           |   19 +-
 benchmarks/distributed/test_many_actors.py         |    8 +-
 benchmarks/distributed/test_many_pgs.py            |    8 +-
 benchmarks/distributed/test_many_tasks.py          |   15 +-
 benchmarks/distributed/test_scheduling.py          |   56 +-
 benchmarks/distributed/wait_cluster.py             |    3 +-
 benchmarks/object_store/test_object_store.py       |    4 +-
 benchmarks/single_node/test_single_node.py         |    7 +-
 ci/remote-watch.py                                 |   55 +-
 ci/repro-ci.py                                     |  271 +--
 ci/travis/bazel-sharding.py                        |   22 +-
 ci/travis/bazel.py                                 |   32 +-
 ci/travis/build-docker-images.py                   |  289 +--
 ci/travis/build-multinode-image.py                 |    3 +-
 ci/travis/check-bazel-team-owner.py                |    7 +-
 ci/travis/check_import_order.py                    |   19 +-
 ci/travis/check_minimal_install.py                 |   23 +-
 ci/travis/clang-tidy-diff.py                       |   85 +-
 ci/travis/determine_tests_to_run.py                |   68 +-
 ci/travis/format.sh                                |    2 +-
 ci/travis/get_build_info.py                        |   32 +-
 ci/travis/py_dep_analysis.py                       |   95 +-
 ci/travis/py_dep_analysis_test.py                  |   46 +-
 dashboard/agent.py                                 |  199 +-
 dashboard/consts.py                                |    9 +-
 dashboard/dashboard.py                             |  136 +-
 dashboard/datacenter.py                            |   56 +-
 dashboard/head.py                                  |  137 +-
 dashboard/http_server_agent.py                     |   24 +-
 dashboard/k8s_utils.py                             |   15 +-
 dashboard/memory_utils.py                          |  171 +-
 dashboard/modules/actor/actor_head.py              |   99 +-
 dashboard/modules/actor/actor_utils.py             |   18 +-
 dashboard/modules/actor/tests/test_actor.py        |  100 +-
 dashboard/modules/event/event_agent.py             |   35 +-
 dashboard/modules/event/event_consts.py            |   16 +-
 dashboard/modules/event/event_head.py              |   14 +-
 dashboard/modules/event/event_utils.py             |   89 +-
 dashboard/modules/event/tests/test_event.py        |   94 +-
 dashboard/modules/job/cli.py                       |  122 +-
 dashboard/modules/job/common.py                    |   36 +-
 dashboard/modules/job/job_head.py                  |   74 +-
 dashboard/modules/job/job_manager.py               |  129 +-
 dashboard/modules/job/sdk.py                       |  212 +-
 .../subprocess_driver_scripts/override_env_var.py  |    8 +-
 .../job/tests/test_backwards_compatibility.py      |   12 +-
 dashboard/modules/job/tests/test_cli.py            |   93 +-
 .../modules/job/tests/test_cli_integration.py      |   54 +-
 dashboard/modules/job/tests/test_common.py         |   72 +-
 .../modules/job/tests/test_http_job_server.py      |  116 +-
 dashboard/modules/job/tests/test_job_manager.py    |  290 ++-
 dashboard/modules/job/tests/test_utils.py          |    2 +-
 dashboard/modules/log/log_head.py                  |   26 +-
 dashboard/modules/log/tests/test_log.py            |   38 +-
 dashboard/modules/node/node_head.py                |  119 +-
 dashboard/modules/node/tests/test_node.py          |  157 +-
 dashboard/modules/reporter/reporter_agent.py       |  357 ++--
 dashboard/modules/reporter/reporter_consts.py      |    3 +-
 dashboard/modules/reporter/reporter_head.py        |   63 +-
 dashboard/modules/reporter/tests/test_reporter.py  |  138 +-
 dashboard/modules/runtime_env/runtime_env_agent.py |  111 +-
 .../modules/runtime_env/runtime_env_consts.py      |    6 +-
 dashboard/modules/snapshot/snapshot_head.py        |  104 +-
 dashboard/modules/snapshot/tests/test_actors.py    |    7 +-
 .../modules/snapshot/tests/test_job_submission.py  |   58 +-
 dashboard/modules/snapshot/tests/test_snapshot.py  |   46 +-
 dashboard/modules/test/test_agent.py               |    6 +-
 dashboard/modules/test/test_head.py                |   21 +-
 dashboard/modules/tune/tune_head.py                |   56 +-
 dashboard/optional_utils.py                        |   57 +-
 dashboard/tests/test_dashboard.py                  |  182 +-
 dashboard/tests/test_memory_utils.py               |  137 +-
 dashboard/utils.py                                 |   79 +-
 doc/kubernetes/example_scripts/job_example.py      |   15 +-
 .../example_scripts/run_local_example.py           |   15 +-
 doc/kubernetes/example_scripts/run_on_head.py      |   14 +-
 doc/source/cluster/examples/slurm-launch.py        |   42 +-
 doc/source/conf.py                                 |   21 +-
 doc/source/custom_directives.py                    |   41 +-
 doc/source/data/_examples/big_data_ingestion.py    |   59 +-
 .../_examples/cython/cython_examples/__init__.py   |   35 +-
 .../ray-core/_examples/cython/cython_main.py       |    6 +-
 doc/source/ray-core/_examples/cython/setup.py      |    4 +-
 .../ray-core/_examples/cython/tests/test_cython.py |    1 +
 .../_examples/dask_xgboost/dask_xgboost.py         |   64 +-
 .../_examples/datasets_train/datasets_train.py     |  240 +--
 .../ray-core/_examples/doc_code/metrics_example.py |    9 +-
 doc/source/ray-core/_examples/lbfgs/driver.py      |   22 +-
 doc/source/ray-core/_examples/lm/ray_train.py      |   39 +-
 .../_examples/modin_xgboost/modin_xgboost.py       |   49 +-
 doc/source/ray-core/_examples/newsreader/server.py |   49 +-
 .../ray-core/_examples/plot_hyperparameter.py      |   52 +-
 .../ray-core/_examples/plot_parameter_server.py    |   25 +-
 doc/source/ray-core/_examples/plot_pong_example.py |   22 +-
 doc/source/ray-core/_examples/progress_bar.py      |    1 +
 .../ray-core/_examples/streaming/streaming.py      |   35 +-
 .../_tutorials/tune-serve-integration-mnist.py     |  197 +-
 doc/source/tune/_tutorials/tune-sklearn.py         |   11 +-
 doc/yarn/example.py                                |   14 +-
 docker/kuberay-autoscaler/run_autoscaler.py        |   11 +-
 .../run_autoscaler_with_retries.py                 |    5 +-
 docker/retag-lambda/lambda_function.py             |   29 +-
 .../resources/test_cross_language_invocation.py    |   57 +-
 python/ray/__init__.py                             |   98 +-
 python/ray/_private/client_mode_hook.py            |   12 +-
 python/ray/_private/compat.py                      |    6 +-
 python/ray/_private/function_manager.py            |  302 +--
 python/ray/_private/gcs_pubsub.py                  |  179 +-
 python/ray/_private/gcs_utils.py                   |  117 +-
 python/ray/_private/import_thread.py               |   69 +-
 python/ray/_private/log_monitor.py                 |  196 +-
 python/ray/_private/memory_monitor.py              |   78 +-
 python/ray/_private/metrics_agent.py               |   90 +-
 python/ray/_private/parameter.py                   |  192 +-
 python/ray/_private/profiling.py                   |    3 +-
 python/ray/_private/prometheus_exporter.py         |  115 +-
 python/ray/_private/ray_client_microbenchmark.py   |    8 +-
 python/ray/_private/ray_cluster_perf.py            |   17 +-
 python/ray/_private/ray_logging.py                 |   82 +-
 python/ray/_private/ray_perf.py                    |   55 +-
 python/ray/_private/ray_process_reaper.py          |    1 +
 python/ray/_private/resource_spec.py               |  159 +-
 python/ray/_private/runtime_env/__init__.py        |    4 +-
 python/ray/_private/runtime_env/conda.py           |  119 +-
 python/ray/_private/runtime_env/conda_utils.py     |   61 +-
 python/ray/_private/runtime_env/container.py       |   48 +-
 python/ray/_private/runtime_env/context.py         |   14 +-
 python/ray/_private/runtime_env/packaging.py       |  190 +-
 python/ray/_private/runtime_env/pip.py             |   38 +-
 python/ray/_private/runtime_env/plugin.py          |   11 +-
 python/ray/_private/runtime_env/py_modules.py      |   52 +-
 python/ray/_private/runtime_env/utils.py           |  203 +-
 python/ray/_private/runtime_env/validation.py      |   98 +-
 python/ray/_private/runtime_env/working_dir.py     |   55 +-
 python/ray/_private/services.py                    |  897 +++++----
 python/ray/_private/signature.py                   |   21 +-
 python/ray/_private/test_utils.py                  |  394 ++--
 .../ray/_private/thirdparty/pathspec/__init__.py   |   44 +-
 python/ray/_private/thirdparty/pathspec/compat.py  |   37 +-
 .../ray/_private/thirdparty/pathspec/pathspec.py   |  380 ++--
 python/ray/_private/thirdparty/pathspec/pattern.py |  248 +--
 .../thirdparty/pathspec/patterns/gitwildmatch.py   |  620 +++---
 python/ray/_private/thirdparty/pathspec/util.py    |  902 ++++-----
 python/ray/_private/tls_utils.py                   |   53 +-
 python/ray/_private/utils.py                       |  273 +--
 python/ray/actor.py                                |  643 +++---
 python/ray/autoscaler/_private/_azure/config.py    |   49 +-
 .../autoscaler/_private/_azure/node_provider.py    |  147 +-
 .../ray/autoscaler/_private/_kubernetes/config.py  |   89 +-
 .../_private/_kubernetes/node_provider.py          |  108 +-
 python/ray/autoscaler/_private/aliyun/config.py    |   23 +-
 .../autoscaler/_private/aliyun/node_provider.py    |  142 +-
 python/ray/autoscaler/_private/aliyun/utils.py     |  182 +-
 python/ray/autoscaler/_private/autoscaler.py       |  548 ++---
 .../_private/aws/cloudwatch/cloudwatch_helper.py   |  434 ++--
 python/ray/autoscaler/_private/aws/config.py       |  378 ++--
 .../ray/autoscaler/_private/aws/node_provider.py   |  286 +--
 python/ray/autoscaler/_private/aws/utils.py        |   54 +-
 python/ray/autoscaler/_private/cli_logger.py       |  161 +-
 .../ray/autoscaler/_private/cli_logger_demoall.py  |    3 +-
 python/ray/autoscaler/_private/cluster_dump.py     |  195 +-
 python/ray/autoscaler/_private/command_runner.py   |  681 ++++---
 python/ray/autoscaler/_private/commands.py         |  804 ++++----
 python/ray/autoscaler/_private/constants.py        |   22 +-
 python/ray/autoscaler/_private/docker.py           |   71 +-
 python/ray/autoscaler/_private/event_summarizer.py |    8 +-
 python/ray/autoscaler/_private/event_system.py     |   25 +-
 .../_private/fake_multi_node/command_runner.py     |   44 +-
 .../_private/fake_multi_node/docker_monitor.py     |  106 +-
 .../_private/fake_multi_node/node_provider.py      |  236 ++-
 .../_private/fake_multi_node/test_utils.py         |   97 +-
 python/ray/autoscaler/_private/gcp/config.py       |  362 ++--
 python/ray/autoscaler/_private/gcp/node.py         |  421 ++--
 .../ray/autoscaler/_private/gcp/node_provider.py   |   39 +-
 .../autoscaler/_private/kuberay/node_provider.py   |  201 +-
 .../ray/autoscaler/_private/legacy_info_string.py  |   13 +-
 python/ray/autoscaler/_private/load_metrics.py     |  155 +-
 python/ray/autoscaler/_private/local/config.py     |   35 +-
 .../_private/local/coordinator_node_provider.py    |   31 +-
 .../ray/autoscaler/_private/local/node_provider.py |   81 +-
 python/ray/autoscaler/_private/log_timer.py        |   13 +-
 python/ray/autoscaler/_private/monitor.py          |  249 ++-
 python/ray/autoscaler/_private/node_launcher.py    |   57 +-
 python/ray/autoscaler/_private/node_tracker.py     |    6 +-
 python/ray/autoscaler/_private/prom_metrics.py     |   90 +-
 python/ray/autoscaler/_private/providers.py        |   80 +-
 .../autoscaler/_private/readonly/node_provider.py  |   13 +-
 .../_private/resource_demand_scheduler.py          |  492 +++--
 .../autoscaler/_private/staroid/command_runner.py  |   19 +-
 .../autoscaler/_private/staroid/node_provider.py   |  153 +-
 .../autoscaler/_private/subprocess_output_util.py  |  170 +-
 python/ray/autoscaler/_private/updater.py          |  346 ++--
 python/ray/autoscaler/_private/util.py             |  165 +-
 python/ray/autoscaler/command_runner.py            |   39 +-
 python/ray/autoscaler/local/coordinator_server.py  |   32 +-
 python/ray/autoscaler/node_provider.py             |   64 +-
 python/ray/autoscaler/sdk/__init__.py              |   33 +-
 python/ray/autoscaler/sdk/sdk.py                   |  111 +-
 python/ray/client_builder.py                       |   78 +-
 python/ray/cluster_utils.py                        |  101 +-
 python/ray/cross_language.py                       |   27 +-
 python/ray/data/__init__.py                        |   27 +-
 python/ray/data/aggregate.py                       |   40 +-
 python/ray/data/block.py                           |   92 +-
 python/ray/data/context.py                         |   14 +-
 python/ray/data/dataset.py                         |  689 ++++---
 python/ray/data/dataset_pipeline.py                |  197 +-
 python/ray/data/datasource/__init__.py             |   19 +-
 python/ray/data/datasource/binary_datasource.py    |    2 +-
 python/ray/data/datasource/csv_datasource.py       |   26 +-
 python/ray/data/datasource/datasource.py           |  126 +-
 .../ray/data/datasource/file_based_datasource.py   |  230 ++-
 python/ray/data/datasource/json_datasource.py      |   21 +-
 python/ray/data/datasource/numpy_datasource.py     |   23 +-
 python/ray/data/datasource/parquet_datasource.py   |  120 +-
 python/ray/data/examples/demo_infer.py             |   11 +-
 python/ray/data/examples/demo_map.py               |    2 +-
 python/ray/data/extensions/__init__.py             |    6 +-
 python/ray/data/extensions/tensor_extension.py     |  166 +-
 python/ray/data/grouped_dataset.py                 |   63 +-
 python/ray/data/impl/arrow_block.py                |   69 +-
 python/ray/data/impl/batcher.py                    |   20 +-
 python/ray/data/impl/block_list.py                 |   23 +-
 python/ray/data/impl/compute.py                    |   71 +-
 python/ray/data/impl/delegating_block_builder.py   |    1 +
 python/ray/data/impl/lazy_block_list.py            |   60 +-
 python/ray/data/impl/output_buffer.py              |   13 +-
 python/ray/data/impl/pipeline_executor.py          |   30 +-
 python/ray/data/impl/progress_bar.py               |    6 +-
 python/ray/data/impl/remote_fn.py                  |    7 +-
 python/ray/data/impl/shuffle.py                    |   50 +-
 python/ray/data/impl/simple_block.py               |   86 +-
 python/ray/data/impl/size_estimator.py             |    7 +-
 python/ray/data/impl/sort.py                       |   34 +-
 python/ray/data/impl/stats.py                      |  151 +-
 python/ray/data/impl/table_block.py                |   21 +-
 python/ray/data/impl/util.py                       |   51 +-
 python/ray/data/read_api.py                        |  297 ++-
 python/ray/data/tests/conftest.py                  |   26 +-
 python/ray/data/tests/mock_server.py               |    8 +-
 python/ray/data/tests/test_context_propagation.py  |   19 +-
 python/ray/data/tests/test_dataset.py              | 1874 +++++++++--------
 python/ray/data/tests/test_dataset_pipeline.py     |   36 +-
 python/ray/data/tests/test_raydp_dataset.py        |   11 +-
 python/ray/data/tests/test_size_estimation.py      |   26 +-
 python/ray/data/tests/test_stats.py                |   26 +-
 python/ray/exceptions.py                           |  205 +-
 python/ray/experimental/__init__.py                |    1 +
 .../ray/experimental/array/distributed/__init__.py |   42 +-
 python/ray/experimental/array/distributed/core.py  |  154 +-
 .../ray/experimental/array/distributed/linalg.py   |   42 +-
 .../ray/experimental/array/distributed/random.py   |    3 +-
 python/ray/experimental/array/remote/__init__.py   |   46 +-
 python/ray/experimental/array/remote/linalg.py     |   23 +-
 python/ray/experimental/dynamic_resources.py       |    3 +-
 python/ray/experimental/internal_kv.py             |   55 +-
 .../experimental/job/example_job/demo_script.py    |   21 +-
 python/ray/experimental/locations.py               |    8 +-
 .../packaging/example_pkg/my_pkg/stubs.py          |    2 +
 python/ray/experimental/packaging/load_package.py  |   77 +-
 python/ray/experimental/queue.py                   |    6 +-
 python/ray/experimental/raysort/main.py            |  100 +-
 python/ray/experimental/raysort/sortlib.py         |    7 +-
 python/ray/experimental/raysort/tracing_utils.py   |   30 +-
 python/ray/experimental/shuffle.py                 |  109 +-
 python/ray/experimental/tf_utils.py                |   51 +-
 python/ray/external_storage.py                     |  155 +-
 python/ray/internal/internal_api.py                |  116 +-
 python/ray/job_config.py                           |   51 +-
 python/ray/node.py                                 |  586 +++---
 python/ray/ray_constants.py                        |   56 +-
 python/ray/ray_operator/operator.py                |   54 +-
 python/ray/ray_operator/operator_utils.py          |  106 +-
 python/ray/remote_function.py                      |  279 ++-
 python/ray/runtime_context.py                      |   19 +-
 python/ray/scripts/scripts.py                      | 1159 ++++++-----
 python/ray/serialization.py                        |  157 +-
 python/ray/serialization_addons.py                 |    2 +-
 python/ray/serve/__init__.py                       |   28 +-
 python/ray/serve/api.py                            |  476 +++--
 python/ray/serve/async_goal_manager.py             |   30 +-
 python/ray/serve/autoscaling_metrics.py            |   33 +-
 python/ray/serve/autoscaling_policy.py             |   50 +-
 python/ray/serve/batching.py                       |   55 +-
 .../ray/serve/benchmarks/baselines/uvicorn_app.py  |   26 +-
 python/ray/serve/benchmarks/handle.py              |    3 +-
 python/ray/serve/benchmarks/microbenchmark.py      |   64 +-
 python/ray/serve/benchmarks/noop_latency.py        |   12 +-
 python/ray/serve/benchmarks/scalability.py         |   22 +-
 python/ray/serve/common.py                         |   30 +-
 python/ray/serve/config.py                         |  100 +-
 python/ray/serve/controller.py                     |  155 +-
 python/ray/serve/deployment_state.py               |  681 ++++---
 python/ray/serve/endpoint_state.py                 |   23 +-
 python/ray/serve/examples/doc/conda_env.py         |   14 +-
 python/ray/serve/examples/doc/delayed_import.py    |    1 +
 python/ray/serve/examples/doc/e2e_deployment.py    |    1 +
 .../ray/serve/examples/doc/e2e_fastapi_client.py   |   16 +-
 python/ray/serve/examples/doc/e2e_local.py         |   14 +-
 python/ray/serve/examples/doc/e2e_router_client.py |   14 +-
 .../serve/examples/doc/e2e_summarizer_client.py    |   14 +-
 .../serve/examples/doc/snippet_custom_metric.py    |    7 +-
 python/ray/serve/examples/doc/snippet_pipeline.py  |   42 +-
 python/ray/serve/examples/doc/tutorial_pytorch.py  |   31 +-
 python/ray/serve/examples/doc/tutorial_rllib.py    |   12 +-
 python/ray/serve/examples/doc/tutorial_sklearn.py  |   13 +-
 .../ray/serve/examples/doc/tutorial_tensorflow.py  |   25 +-
 python/ray/serve/handle.py                         |   71 +-
 python/ray/serve/http_proxy.py                     |  141 +-
 python/ray/serve/http_state.py                     |   74 +-
 python/ray/serve/http_util.py                      |   46 +-
 python/ray/serve/long_poll.py                      |   73 +-
 python/ray/serve/pipeline/common.py                |    5 +-
 python/ray/serve/pipeline/executor.py              |   15 +-
 python/ray/serve/pipeline/node.py                  |   20 +-
 python/ray/serve/pipeline/step.py                  |   39 +-
 python/ray/serve/pipeline/test_utils.py            |    4 +-
 .../serve/pipeline/tests/test_actor_executor.py    |    1 +
 python/ray/serve/pipeline/tests/test_pipeline.py   |   12 +-
 python/ray/serve/pipeline/tests/test_step.py       |   12 +-
 python/ray/serve/replica.py                        |  226 ++-
 python/ray/serve/router.py                         |   93 +-
 python/ray/serve/scripts.py                        |   40 +-
 python/ray/serve/storage/checkpoint_path.py        |   34 +-
 python/ray/serve/storage/kv_store.py               |   93 +-
 python/ray/serve/storage/ray_gcs_kv_store.py       |   30 +-
 python/ray/serve/tests/conftest.py                 |    6 +-
 .../test_controller_recovery.py                    |   69 +-
 .../ray/serve/tests/storage_tests/test_kv_store.py |   20 +-
 python/ray/serve/tests/test_advanced.py            |    4 +-
 python/ray/serve/tests/test_api.py                 |   46 +-
 python/ray/serve/tests/test_async_goal_manager.py  |    1 +
 python/ray/serve/tests/test_autoscaling_metrics.py |   25 +-
 python/ray/serve/tests/test_autoscaling_policy.py  |  267 +--
 python/ray/serve/tests/test_batching.py            |    5 +-
 python/ray/serve/tests/test_cli.py                 |   51 +-
 python/ray/serve/tests/test_cluster.py             |    3 +-
 python/ray/serve/tests/test_common.py              |   11 +-
 python/ray/serve/tests/test_config.py              |   27 +-
 python/ray/serve/tests/test_constructor_failure.py |   18 +-
 python/ray/serve/tests/test_controller.py          |   10 +-
 python/ray/serve/tests/test_deploy.py              |   70 +-
 python/ray/serve/tests/test_deployment_state.py    |  834 ++++----
 python/ray/serve/tests/test_deployment_version.py  |    9 +-
 python/ray/serve/tests/test_failure.py             |   12 +-
 python/ray/serve/tests/test_fastapi.py             |   85 +-
 python/ray/serve/tests/test_get_deployment.py      |    1 +
 python/ray/serve/tests/test_handle.py              |    5 +-
 .../ray/serve/tests/test_http_prefix_matching.py   |   29 +-
 python/ray/serve/tests/test_http_routes.py         |    7 +-
 python/ray/serve/tests/test_http_state.py          |   20 +-
 python/ray/serve/tests/test_logs.py                |   26 +-
 python/ray/serve/tests/test_long_poll.py           |   14 +-
 python/ray/serve/tests/test_metrics.py             |   20 +-
 python/ray/serve/tests/test_persistence.py         |    5 +-
 python/ray/serve/tests/test_ray_client.py          |   57 +-
 python/ray/serve/tests/test_regression.py          |    2 +
 python/ray/serve/tests/test_router.py              |   13 +-
 python/ray/serve/tests/test_runtime_env.py         |   58 +-
 python/ray/serve/tests/test_standalone.py          |  149 +-
 python/ray/serve/tests/test_util.py                |    1 +
 python/ray/serve/utils.py                          |   44 +-
 python/ray/serve/version.py                        |   10 +-
 python/ray/setup-dev.py                            |   44 +-
 python/ray/state.py                                |  197 +-
 python/ray/streaming/__init__.py                   |    6 +-
 python/ray/tests/aws/test_autoscaler_aws.py        |  236 ++-
 python/ray/tests/aws/test_aws_batch_tag_update.py  |   18 +-
 python/ray/tests/aws/utils/constants.py            |  153 +-
 python/ray/tests/aws/utils/helpers.py              |   35 +-
 python/ray/tests/aws/utils/stubs.py                |  122 +-
 python/ray/tests/client_test_utils.py              |    1 +
 python/ray/tests/conftest.py                       |  120 +-
 python/ray/tests/gcp/test_gcp_node_provider.py     |   47 +-
 python/ray/tests/kubernetes_e2e/test_helm.py       |   32 +-
 .../kubernetes_e2e/test_k8s_operator_basic.py      |  114 +-
 .../kubernetes_e2e/test_k8s_operator_scaling.py    |   38 +-
 python/ray/tests/ludwig/ludwig_test_utils.py       |   80 +-
 python/ray/tests/ludwig/test_ludwig.py             |   34 +-
 python/ray/tests/mock_setup_worker.py              |   24 +-
 python/ray/tests/modin/modin_test_utils.py         |   51 +-
 python/ray/tests/modin/test_modin.py               |  217 +-
 .../test_perf_integration.py                       |   34 +-
 python/ray/tests/test_actor.py                     |   77 +-
 python/ray/tests/test_actor_advanced.py            |  229 +--
 python/ray/tests/test_actor_failures.py            |   90 +-
 python/ray/tests/test_actor_in_container.py        |   12 +-
 python/ray/tests/test_actor_lifetime.py            |   14 +-
 python/ray/tests/test_actor_out_of_order.py        |    1 +
 python/ray/tests/test_actor_resources.py           |  115 +-
 python/ray/tests/test_advanced.py                  |  134 +-
 python/ray/tests/test_advanced_2.py                |  123 +-
 python/ray/tests/test_advanced_3.py                |  201 +-
 python/ray/tests/test_advanced_4.py                |   79 +-
 python/ray/tests/test_args.py                      |   37 +-
 python/ray/tests/test_array.py                     |   94 +-
 python/ray/tests/test_async.py                     |   12 +-
 python/ray/tests/test_asyncio.py                   |   23 +-
 python/ray/tests/test_asyncio_cluster.py           |    1 +
 python/ray/tests/test_autoscaler.py                | 1353 +++++++------
 python/ray/tests/test_autoscaler_drain_node_api.py |   20 +-
 python/ray/tests/test_autoscaler_fake_multinode.py |    7 +-
 python/ray/tests/test_autoscaler_gcp.py            |   15 +-
 python/ray/tests/test_autoscaler_yaml.py           |  502 ++---
 python/ray/tests/test_autoscaling_policy.py        |  168 +-
 python/ray/tests/test_basic.py                     |  139 +-
 python/ray/tests/test_basic_2.py                   |  102 +-
 python/ray/tests/test_basic_3.py                   |   28 +-
 python/ray/tests/test_basic_4.py                   |   34 +-
 python/ray/tests/test_basic_5.py                   |   21 +-
 python/ray/tests/test_cancel.py                    |   28 +-
 python/ray/tests/test_chaos.py                     |   56 +-
 python/ray/tests/test_cli.py                       |  296 ++-
 python/ray/tests/test_cli_logger.py                |    1 +
 python/ray/tests/test_client.py                    |   65 +-
 python/ray/tests/test_client_builder.py            |  127 +-
 python/ray/tests/test_client_compat.py             |    7 +-
 python/ray/tests/test_client_init.py               |   27 +-
 .../ray/tests/test_client_library_integration.py   |   10 +-
 python/ray/tests/test_client_metadata.py           |    1 +
 python/ray/tests/test_client_multi.py              |   49 +-
 python/ray/tests/test_client_proxy.py              |  139 +-
 python/ray/tests/test_client_reconnect.py          |  110 +-
 python/ray/tests/test_client_references.py         |   36 +-
 python/ray/tests/test_client_terminate.py          |   19 +-
 python/ray/tests/test_client_warnings.py           |    5 +-
 python/ray/tests/test_command_runner.py            |  161 +-
 python/ray/tests/test_component_failures.py        |   19 +-
 python/ray/tests/test_component_failures_2.py      |   46 +-
 python/ray/tests/test_component_failures_3.py      |   29 +-
 python/ray/tests/test_coordinator_server.py        |  114 +-
 python/ray/tests/test_dashboard.py                 |   79 +-
 python/ray/tests/test_dataclient_disconnect.py     |   15 +-
 python/ray/tests/test_debug_tools.py               |    7 +-
 python/ray/tests/test_distributed_sort.py          |   20 +-
 python/ray/tests/test_error_ray_not_initialized.py |    6 +-
 python/ray/tests/test_failure.py                   |  113 +-
 python/ray/tests/test_failure_2.py                 |  133 +-
 python/ray/tests/test_failure_3.py                 |   31 +-
 python/ray/tests/test_failure_4.py                 |  100 +-
 python/ray/tests/test_gcs_fault_tolerance.py       |   69 +-
 python/ray/tests/test_gcs_pubsub.py                |  114 +-
 python/ray/tests/test_get_locations.py             |   16 +-
 python/ray/tests/test_global_gc.py                 |   46 +-
 python/ray/tests/test_global_state.py              |   63 +-
 python/ray/tests/test_grpc_client_credentials.py   |    6 +-
 python/ray/tests/test_healthcheck.py               |   18 +-
 python/ray/tests/test_iter.py                      |  107 +-
 python/ray/tests/test_job.py                       |   21 +-
 python/ray/tests/test_joblib.py                    |   43 +-
 python/ray/tests/test_k8s_cluster_launcher.py      |   16 +-
 python/ray/tests/test_k8s_operator_unit_tests.py   |  120 +-
 python/ray/tests/test_list_actors.py               |   24 +-
 python/ray/tests/test_logging.py                   |   55 +-
 python/ray/tests/test_memory_scheduling.py         |    4 +-
 python/ray/tests/test_memstat.py                   |   58 +-
 python/ray/tests/test_metrics.py                   |   49 +-
 python/ray/tests/test_metrics_agent.py             |  143 +-
 python/ray/tests/test_microbenchmarks.py           |    7 +-
 python/ray/tests/test_mini.py                      |    5 +-
 python/ray/tests/test_mldataset.py                 |   18 +-
 python/ray/tests/test_monitor.py                   |   56 +-
 python/ray/tests/test_multi_node.py                |   75 +-
 python/ray/tests/test_multi_node_2.py              |   80 +-
 python/ray/tests/test_multi_node_3.py              |  174 +-
 python/ray/tests/test_multi_tenancy.py             |   70 +-
 python/ray/tests/test_multinode_failures.py        |   49 +-
 python/ray/tests/test_multinode_failures_2.py      |   43 +-
 python/ray/tests/test_multiprocessing.py           |   86 +-
 python/ray/tests/test_namespace.py                 |   14 +-
 python/ray/tests/test_node_manager.py              |    9 +-
 python/ray/tests/test_numba.py                     |    1 +
 python/ray/tests/test_object_assign_owner.py       |   31 +-
 python/ray/tests/test_object_manager.py            |  210 +-
 python/ray/tests/test_object_spilling.py           |  163 +-
 python/ray/tests/test_object_spilling_2.py         |   69 +-
 python/ray/tests/test_object_spilling_3.py         |   30 +-
 python/ray/tests/test_output.py                    |   18 +-
 python/ray/tests/test_placement_group.py           |  176 +-
 python/ray/tests/test_placement_group_2.py         |  194 +-
 python/ray/tests/test_placement_group_3.py         |  159 +-
 .../tests/test_placement_group_mini_integration.py |   20 +-
 python/ray/tests/test_plasma_unlimited.py          |   47 +-
 python/ray/tests/test_pydantic_serialization.py    |    3 +
 python/ray/tests/test_queue.py                     |    7 +-
 .../tests/test_ray_cluster_with_external_redis.py  |    7 +-
 python/ray/tests/test_ray_debugger.py              |  116 +-
 python/ray/tests/test_ray_init.py                  |   95 +-
 python/ray/tests/test_ray_shutdown.py              |   18 +-
 python/ray/tests/test_raylet_output.py             |   23 +-
 python/ray/tests/test_reconstruction.py            |  266 +--
 python/ray/tests/test_reference_counting.py        |   90 +-
 python/ray/tests/test_reference_counting_2.py      |  139 +-
 python/ray/tests/test_resource_demand_scheduler.py | 2118 +++++++++++---------
 python/ray/tests/test_response_cache.py            |    9 +-
 python/ray/tests/test_runtime_context.py           |   35 +-
 python/ray/tests/test_runtime_env.py               |   82 +-
 python/ray/tests/test_runtime_env_complicated.py   |  311 +--
 python/ray/tests/test_runtime_env_conda_and_pip.py |   53 +-
 .../ray/tests/test_runtime_env_conda_and_pip_2.py  |   21 +-
 .../ray/tests/test_runtime_env_conda_and_pip_3.py  |   48 +-
 python/ray/tests/test_runtime_env_env_vars.py      |  210 +-
 python/ray/tests/test_runtime_env_fork_process.py  |   27 +-
 python/ray/tests/test_runtime_env_packaging.py     |  107 +-
 python/ray/tests/test_runtime_env_plugin.py        |   29 +-
 python/ray/tests/test_runtime_env_ray_minimal.py   |   30 +-
 python/ray/tests/test_runtime_env_validation.py    |   83 +-
 python/ray/tests/test_runtime_env_working_dir.py   |  142 +-
 python/ray/tests/test_runtime_env_working_dir_2.py |   57 +-
 python/ray/tests/test_runtime_env_working_dir_3.py |   32 +-
 .../test_runtime_env_working_dir_remote_uri.py     |   18 +-
 python/ray/tests/test_scheduling.py                |  140 +-
 python/ray/tests/test_scheduling_2.py              |  149 +-
 python/ray/tests/test_scheduling_performance.py    |   15 +-
 python/ray/tests/test_serialization.py             |  183 +-
 python/ray/tests/test_serve_ray_minimal.py         |    4 +-
 python/ray/tests/test_setup_worker.py              |   10 +-
 python/ray/tests/test_shuffle.py                   |    9 +-
 python/ray/tests/test_stress.py                    |   11 +-
 python/ray/tests/test_stress_failure.py            |   35 +-
 python/ray/tests/test_stress_sharded.py            |   10 +-
 python/ray/tests/test_tempfile.py                  |   82 +-
 python/ray/tests/test_tensorflow.py                |   51 +-
 python/ray/tests/test_threaded_actor.py            |   62 +-
 python/ray/tests/test_tls_auth.py                  |   31 +-
 python/ray/tests/test_top_level_api.py             |    4 +-
 python/ray/tests/test_traceback.py                 |   37 +-
 python/ray/tests/test_tracing.py                   |   31 +-
 python/ray/tests/test_unhandled_error.py           |    2 +-
 python/ray/tests/test_worker_capping.py            |   13 +-
 python/ray/train/__init__.py                       |   27 +-
 python/ray/train/backend.py                        |  209 +-
 python/ray/train/callbacks/__init__.py             |   12 +-
 python/ray/train/callbacks/logging.py              |  123 +-
 .../callbacks/results_preprocessors/__init__.py    |   20 +-
 .../train/callbacks/results_preprocessors/index.py |    9 +-
 .../train/callbacks/results_preprocessors/keys.py  |   15 +-
 python/ray/train/checkpoint.py                     |  131 +-
 python/ray/train/constants.py                      |    9 +-
 .../ray/train/examples/horovod/horovod_example.py  |  110 +-
 .../train/examples/mlflow_fashion_mnist_example.py |   32 +-
 python/ray/train/examples/mlflow_simple_example.py |    5 +-
 .../examples/tensorflow_linear_dataset_example.py  |   66 +-
 .../ray/train/examples/tensorflow_mnist_example.py |   69 +-
 .../train/examples/train_fashion_mnist_example.py  |   45 +-
 .../train/examples/train_linear_dataset_example.py |   49 +-
 python/ray/train/examples/train_linear_example.py  |   41 +-
 .../examples/transformers/transformers_example.py  |  242 ++-
 .../examples/tune_cifar_pytorch_pbt_example.py     |   86 +-
 .../train/examples/tune_linear_dataset_example.py  |   31 +-
 python/ray/train/examples/tune_linear_example.py   |   20 +-
 .../examples/tune_tensorflow_mnist_example.py      |   23 +-
 python/ray/train/horovod.py                        |   26 +-
 python/ray/train/session.py                        |   77 +-
 python/ray/train/tensorflow.py                     |   33 +-
 python/ray/train/tests/test_backend.py             |   94 +-
 python/ray/train/tests/test_callbacks.py           |   82 +-
 python/ray/train/tests/test_examples.py            |   42 +-
 python/ray/train/tests/test_gpu.py                 |   30 +-
 .../ray/train/tests/test_results_preprocessors.py  |   25 +-
 python/ray/train/tests/test_session.py             |   44 +-
 python/ray/train/tests/test_trainer.py             |  159 +-
 python/ray/train/tests/test_tune.py                |   29 +-
 python/ray/train/tests/test_worker_group.py        |    2 +
 python/ray/train/torch.py                          |   89 +-
 python/ray/train/trainer.py                        |  341 ++--
 python/ray/train/utils.py                          |    6 +-
 python/ray/train/worker_group.py                   |  116 +-
 python/ray/tune/__init__.py                        |   93 +-
 python/ray/tune/analysis/experiment_analysis.py    |  256 +--
 python/ray/tune/automl/__init__.py                 |    3 +-
 python/ray/tune/automl/genetic_searcher.py         |   55 +-
 python/ray/tune/automl/search_policy.py            |   38 +-
 python/ray/tune/automl/search_space.py             |   12 +-
 python/ray/tune/automlboard/backend/collector.py   |   90 +-
 python/ray/tune/automlboard/frontend/query.py      |    8 +-
 python/ray/tune/automlboard/frontend/urls.py       |    2 +-
 python/ray/tune/automlboard/frontend/view.py       |   51 +-
 python/ray/tune/automlboard/frontend/wsgi.py       |    3 +-
 python/ray/tune/automlboard/manage.py              |    3 +-
 python/ray/tune/automlboard/models/models.py       |   12 +-
 python/ray/tune/automlboard/run.py                 |   39 +-
 python/ray/tune/automlboard/settings.py            |    9 +-
 python/ray/tune/callback.py                        |   61 +-
 python/ray/tune/checkpoint_manager.py              |   22 +-
 python/ray/tune/cloud.py                           |  130 +-
 python/ray/tune/cluster_info.py                    |    5 +-
 python/ray/tune/commands.py                        |   98 +-
 python/ray/tune/config_parser.py                   |   56 +-
 python/ray/tune/durable_trainable.py               |    7 +-
 python/ray/tune/error.py                           |    2 +
 .../ray/tune/examples/async_hyperband_example.py   |   20 +-
 python/ray/tune/examples/ax_example.py             |   46 +-
 python/ray/tune/examples/bayesopt_example.py       |   20 +-
 python/ray/tune/examples/blendsearch_example.py    |   25 +-
 python/ray/tune/examples/bohb_example.py           |   15 +-
 python/ray/tune/examples/cfo_example.py            |   14 +-
 .../ray/tune/examples/custom_func_checkpointing.py |   15 +-
 python/ray/tune/examples/ddp_mnist_torch.py        |   34 +-
 python/ray/tune/examples/dragonfly_example.py      |   11 +-
 .../ray/tune/examples/durable_trainable_example.py |   18 +-
 python/ray/tune/examples/genetic_example.py        |   31 +-
 python/ray/tune/examples/hebo_example.py           |   26 +-
 python/ray/tune/examples/horovod_simple.py         |   64 +-
 python/ray/tune/examples/hyperband_example.py      |   15 +-
 .../tune/examples/hyperband_function_example.py    |   10 +-
 .../hyperopt_conditional_search_space_example.py   |   30 +-
 python/ray/tune/examples/hyperopt_example.py       |   26 +-
 python/ray/tune/examples/lightgbm_example.py       |   30 +-
 python/ray/tune/examples/logging_example.py        |   15 +-
 python/ray/tune/examples/mlflow_example.py         |   41 +-
 python/ray/tune/examples/mlflow_ptl.py             |   39 +-
 python/ray/tune/examples/mnist_ptl_mini.py         |   25 +-
 python/ray/tune/examples/mnist_pytorch.py          |   51 +-
 .../ray/tune/examples/mnist_pytorch_trainable.py   |   23 +-
 python/ray/tune/examples/mxnet_example.py          |   38 +-
 python/ray/tune/examples/nevergrad_example.py      |   15 +-
 .../tune/examples/optuna_define_by_run_example.py  |   15 +-
 python/ray/tune/examples/optuna_example.py         |   14 +-
 .../tune/examples/optuna_multiobjective_example.py |   31 +-
 python/ray/tune/examples/pb2_example.py            |   13 +-
 python/ray/tune/examples/pb2_ppo_example.py        |   59 +-
 .../tune/examples/pbt_convnet_function_example.py  |   36 +-
 python/ray/tune/examples/pbt_dcgan_mnist/common.py |   79 +-
 .../pbt_dcgan_mnist/pbt_dcgan_mnist_func.py        |   59 +-
 .../pbt_dcgan_mnist/pbt_dcgan_mnist_trainable.py   |   79 +-
 python/ray/tune/examples/pbt_example.py            |   18 +-
 python/ray/tune/examples/pbt_function.py           |   15 +-
 python/ray/tune/examples/pbt_memnn_example.py      |   95 +-
 python/ray/tune/examples/pbt_ppo_example.py        |   12 +-
 .../examples/pbt_transformers/pbt_transformers.py  |   72 +-
 python/ray/tune/examples/pbt_transformers/utils.py |   11 +-
 .../tune/examples/pbt_tune_cifar10_with_keras.py   |   50 +-
 python/ray/tune/examples/sigopt_example.py         |   30 +-
 .../examples/sigopt_multi_objective_example.py     |   22 +-
 .../tune/examples/sigopt_prior_beliefs_example.py  |   65 +-
 python/ray/tune/examples/skopt_example.py          |   29 +-
 .../tune/examples/tf_distributed_keras_example.py  |   72 +-
 python/ray/tune/examples/tf_mnist_example.py       |   29 +-
 python/ray/tune/examples/tune_basic_example.py     |   14 +-
 python/ray/tune/examples/tune_cifar10_gluon.py     |  124 +-
 python/ray/tune/examples/tune_comet_example.py     |   17 +-
 python/ray/tune/examples/tune_mnist_keras.py       |   49 +-
 python/ray/tune/examples/utils.py                  |    5 +-
 python/ray/tune/examples/wandb_example.py          |   35 +-
 .../examples/xgboost_dynamic_resources_example.py  |   75 +-
 python/ray/tune/examples/xgboost_example.py        |   28 +-
 python/ray/tune/examples/zoopt_example.py          |   17 +-
 python/ray/tune/experiment.py                      |  136 +-
 python/ray/tune/function_runner.py                 |  192 +-
 python/ray/tune/insufficient_resources_manager.py  |   31 +-
 python/ray/tune/integration/comet.py               |   18 +-
 python/ray/tune/integration/docker.py              |   39 +-
 python/ray/tune/integration/horovod.py             |   50 +-
 python/ray/tune/integration/keras.py               |   42 +-
 python/ray/tune/integration/kubernetes.py          |   36 +-
 python/ray/tune/integration/lightgbm.py            |   25 +-
 python/ray/tune/integration/mlflow.py              |   79 +-
 python/ray/tune/integration/mxnet.py               |   17 +-
 python/ray/tune/integration/pytorch_lightning.py   |  136 +-
 python/ray/tune/integration/tensorflow.py          |   84 +-
 python/ray/tune/integration/torch.py               |  112 +-
 python/ray/tune/integration/wandb.py               |   85 +-
 python/ray/tune/integration/xgboost.py             |   22 +-
 python/ray/tune/logger.py                          |  213 +-
 python/ray/tune/progress_reporter.py               |  471 +++--
 python/ray/tune/ray_trial_executor.py              |  252 ++-
 python/ray/tune/registry.py                        |   46 +-
 python/ray/tune/resources.py                       |  170 +-
 python/ray/tune/result.py                          |   29 +-
 python/ray/tune/sample.py                          |  259 ++-
 python/ray/tune/schedulers/__init__.py             |   41 +-
 python/ray/tune/schedulers/async_hyperband.py      |  101 +-
 python/ray/tune/schedulers/hb_bohb.py              |   49 +-
 python/ray/tune/schedulers/hyperband.py            |  160 +-
 python/ray/tune/schedulers/median_stopping_rule.py |   72 +-
 python/ray/tune/schedulers/pb2.py                  |   85 +-
 python/ray/tune/schedulers/pb2_utils.py            |   84 +-
 python/ray/tune/schedulers/pbt.py                  |  417 ++--
 .../tune/schedulers/resource_changing_scheduler.py |  238 ++-
 python/ray/tune/schedulers/trial_scheduler.py      |   61 +-
 python/ray/tune/scripts.py                         |   68 +-
 python/ray/tune/session.py                         |   26 +-
 python/ray/tune/sklearn.py                         |    6 +-
 python/ray/tune/stopper.py                         |   64 +-
 python/ray/tune/suggest/__init__.py                |   64 +-
 python/ray/tune/suggest/_mock.py                   |   10 +-
 python/ray/tune/suggest/ax.py                      |  164 +-
 python/ray/tune/suggest/basic_variant.py           |  109 +-
 python/ray/tune/suggest/bayesopt.py                |  130 +-
 python/ray/tune/suggest/bohb.py                    |  137 +-
 python/ray/tune/suggest/dragonfly.py               |  171 +-
 python/ray/tune/suggest/hebo.py                    |  235 ++-
 python/ray/tune/suggest/hyperopt.py                |  242 ++-
 python/ray/tune/suggest/nevergrad.py               |  148 +-
 python/ray/tune/suggest/optuna.py                  |  243 ++-
 python/ray/tune/suggest/repeater.py                |   50 +-
 python/ray/tune/suggest/search.py                  |   17 +-
 python/ray/tune/suggest/search_generator.py        |   90 +-
 python/ray/tune/suggest/sigopt.py                  |  124 +-
 python/ray/tune/suggest/skopt.py                   |  159 +-
 python/ray/tune/suggest/suggestion.py              |  180 +-
 python/ray/tune/suggest/util.py                    |   14 +-
 python/ray/tune/suggest/variant_generator.py       |  137 +-
 python/ray/tune/suggest/zoopt.py                   |  116 +-
 python/ray/tune/sync_client.py                     |  105 +-
 python/ray/tune/syncer.py                          |  178 +-
 .../tune/tests/_test_cluster_interrupt_searcher.py |   23 +-
 python/ray/tune/tests/example.py                   |   10 +-
 python/ray/tune/tests/test_actor_reuse.py          |   59 +-
 python/ray/tune/tests/test_api.py                  |  678 ++++---
 python/ray/tune/tests/test_automl_searcher.py      |   31 +-
 python/ray/tune/tests/test_checkpoint_manager.py   |   50 +-
 python/ray/tune/tests/test_client.py               |   21 +-
 python/ray/tune/tests/test_cloud.py                |   90 +-
 python/ray/tune/tests/test_cluster.py              |  134 +-
 python/ray/tune/tests/test_cluster_searcher.py     |   39 +-
 python/ray/tune/tests/test_commands.py             |   46 +-
 python/ray/tune/tests/test_convergence.py          |   15 +-
 python/ray/tune/tests/test_dependency.py           |    9 +-
 python/ray/tune/tests/test_experiment.py           |   35 +-
 python/ray/tune/tests/test_experiment_analysis.py  |   94 +-
 .../ray/tune/tests/test_experiment_analysis_mem.py |  119 +-
 python/ray/tune/tests/test_function_api.py         |   85 +-
 python/ray/tune/tests/test_horovod.py              |   21 +-
 python/ray/tune/tests/test_integration_comet.py    |   50 +-
 python/ray/tune/tests/test_integration_docker.py   |   46 +-
 .../ray/tune/tests/test_integration_kubernetes.py  |   47 +-
 python/ray/tune/tests/test_integration_mlflow.py   |   91 +-
 .../tests/test_integration_pytorch_lightning.py    |   58 +-
 python/ray/tune/tests/test_integration_wandb.py    |  141 +-
 python/ray/tune/tests/test_logger.py               |   91 +-
 python/ray/tune/tests/test_multinode_sync.py       |  104 +-
 python/ray/tune/tests/test_progress_reporter.py    |  112 +-
 python/ray/tune/tests/test_ray_trial_executor.py   |  149 +-
 python/ray/tune/tests/test_remote.py               |   27 +-
 python/ray/tune/tests/test_run_experiment.py       |  211 +-
 python/ray/tune/tests/test_sample.py               |  805 ++++----
 python/ray/tune/tests/test_searchers.py            |  222 +-
 python/ray/tune/tests/test_soft_imports.py         |    5 +-
 python/ray/tune/tests/test_sync.py                 |  201 +-
 python/ray/tune/tests/test_tensorflow_trainable.py |   14 +-
 python/ray/tune/tests/test_torch_trainable.py      |   27 +-
 python/ray/tune/tests/test_trainable_util.py       |   80 +-
 .../tune/tests/test_trial_executor_inheritance.py  |   10 +-
 python/ray/tune/tests/test_trial_runner.py         |   89 +-
 python/ray/tune/tests/test_trial_runner_2.py       |   21 +-
 python/ray/tune/tests/test_trial_runner_3.py       |  203 +-
 .../ray/tune/tests/test_trial_runner_callbacks.py  |  112 +-
 python/ray/tune/tests/test_trial_runner_pg.py      |  101 +-
 python/ray/tune/tests/test_trial_scheduler.py      |  785 ++++----
 python/ray/tune/tests/test_trial_scheduler_pbt.py  |  102 +-
 python/ray/tune/tests/test_tune_restore.py         |  105 +-
 .../ray/tune/tests/test_tune_restore_warm_start.py |  253 +--
 python/ray/tune/tests/test_tune_save_restore.py    |   55 +-
 python/ray/tune/tests/test_tune_server.py          |   45 +-
 python/ray/tune/tests/test_var.py                  |  380 ++--
 python/ray/tune/tests/tutorial.py                  |   18 +-
 python/ray/tune/trainable.py                       |  167 +-
 python/ray/tune/trial.py                           |  237 ++-
 python/ray/tune/trial_executor.py                  |   42 +-
 python/ray/tune/trial_runner.py                    |  558 +++---
 python/ray/tune/tune.py                            |  273 +--
 python/ray/tune/utils/__init__.py                  |   41 +-
 python/ray/tune/utils/callback.py                  |   57 +-
 python/ray/tune/utils/log.py                       |    1 +
 python/ray/tune/utils/mock.py                      |   51 +-
 python/ray/tune/utils/placement_groups.py          |  152 +-
 python/ray/tune/utils/release_test_util.py         |  101 +-
 python/ray/tune/utils/serialization.py             |    5 +-
 python/ray/tune/utils/trainable.py                 |   88 +-
 python/ray/tune/utils/util.py                      |  198 +-
 python/ray/tune/utils/visual_utils.py              |    8 +-
 python/ray/tune/web_server.py                      |   26 +-
 python/ray/util/__init__.py                        |   17 +-
 python/ray/util/accelerators/__init__.py           |   16 +-
 python/ray/util/actor_group.py                     |   83 +-
 python/ray/util/actor_pool.py                      |    8 +-
 python/ray/util/annotations.py                     |   15 +-
 python/ray/util/check_serialize.py                 |   90 +-
 python/ray/util/client/__init__.py                 |   76 +-
 python/ray/util/client/api.py                      |   67 +-
 python/ray/util/client/client_pickler.py           |   29 +-
 python/ray/util/client/common.py                   |  167 +-
 python/ray/util/client/dataclient.py               |  154 +-
 python/ray/util/client/logsclient.py               |   14 +-
 python/ray/util/client/options.py                  |   51 +-
 python/ray/util/client/ray_client_helpers.py       |   14 +-
 python/ray/util/client/runtime_context.py          |    9 +-
 python/ray/util/client/server/__main__.py          |    1 +
 python/ray/util/client/server/dataservicer.py      |  122 +-
 python/ray/util/client/server/logservicer.py       |   14 +-
 python/ray/util/client/server/proxier.py           |  250 ++-
 python/ray/util/client/server/server.py            |  351 ++--
 python/ray/util/client/server/server_pickler.py    |   37 +-
 python/ray/util/client/server/server_stubs.py      |   13 +-
 python/ray/util/client/worker.py                   |  265 ++-
 python/ray/util/client_connect.py                  |   30 +-
 python/ray/util/collective/__init__.py             |   62 +-
 python/ray/util/collective/collective.py           |  224 ++-
 .../collective_group/base_collective_group.py      |   22 +-
 .../collective/collective_group/cuda_stream.py     |    3 +-
 .../collective_group/gloo_collective_group.py      |  214 +-
 .../util/collective/collective_group/gloo_util.py  |   75 +-
 .../collective_group/nccl_collective_group.py      |  243 ++-
 .../util/collective/collective_group/nccl_util.py  |   94 +-
 .../collective/examples/nccl_allreduce_example.py  |    6 +-
 ...l_allreduce_example_declare_collective_group.py |    4 +-
 .../examples/nccl_allreduce_multigpu_example.py    |    6 +-
 .../examples/nccl_p2p_example_multigpu.py          |    8 +-
 python/ray/util/collective/tests/conftest.py       |   10 +-
 python/ray/util/collective/tests/cpu_util.py       |   40 +-
 .../test_distributed_allgather.py                  |   65 +-
 .../test_distributed_allreduce.py                  |  161 +-
 .../test_distributed_basic_apis.py                 |   62 +-
 .../test_distributed_broadcast.py                  |   87 +-
 .../test_distributed_reduce.py                     |  130 +-
 .../test_distributed_reducescatter.py              |   60 +-
 .../test_distributed_sendrecv.py                   |   34 +-
 .../test_distributed_allgather.py                  |   69 +-
 .../test_distributed_allreduce.py                  |  172 +-
 .../test_distributed_basic_apis.py                 |   51 +-
 .../test_distributed_broadcast.py                  |   81 +-
 .../test_distributed_reduce.py                     |  122 +-
 .../test_distributed_reducescatter.py              |   72 +-
 .../test_distributed_sendrecv.py                   |   33 +-
 .../test_distributed_multigpu_allgather.py         |   69 +-
 .../test_distributed_multigpu_allreduce.py         |  144 +-
 .../test_distributed_multigpu_basic_apis.py        |   35 +-
 .../test_distributed_multigpu_broadcast.py         |   92 +-
 .../test_distributed_multigpu_reduce.py            |  175 +-
 .../test_distributed_multigpu_reducescatter.py     |   78 +-
 .../test_distributed_multigpu_sendrecv.py          |   39 +-
 .../tests/single_node_cpu_tests/test_allgather.py  |   59 +-
 .../tests/single_node_cpu_tests/test_allreduce.py  |  144 +-
 .../tests/single_node_cpu_tests/test_basic_apis.py |   56 +-
 .../tests/single_node_cpu_tests/test_broadcast.py  |   78 +-
 .../tests/single_node_cpu_tests/test_reduce.py     |  150 +-
 .../single_node_cpu_tests/test_reducescatter.py    |   59 +-
 .../tests/single_node_cpu_tests/test_sendrecv.py   |   47 +-
 .../tests/single_node_gpu_tests/test_allgather.py  |   63 +-
 .../tests/single_node_gpu_tests/test_allreduce.py  |  159 +-
 .../tests/single_node_gpu_tests/test_basic_apis.py |   45 +-
 .../tests/single_node_gpu_tests/test_broadcast.py  |   76 +-
 .../tests/single_node_gpu_tests/test_reduce.py     |  148 +-
 .../single_node_gpu_tests/test_reducescatter.py    |   71 +-
 .../tests/single_node_gpu_tests/test_sendrecv.py   |   46 +-
 python/ray/util/collective/tests/util.py           |  210 +-
 python/ray/util/collective/types.py                |    6 +-
 python/ray/util/collective/util.py                 |    5 +-
 python/ray/util/dask/__init__.py                   |    8 +-
 python/ray/util/dask/callbacks.py                  |   28 +-
 python/ray/util/dask/common.py                     |    9 +-
 .../dask/examples/dask_ray_scheduler_example.py    |    6 +-
 .../dask/examples/dask_ray_shuffle_optimization.py |   16 +-
 python/ray/util/dask/optimizations.py              |   43 +-
 python/ray/util/dask/scheduler.py                  |   77 +-
 python/ray/util/dask/scheduler_utils.py            |   68 +-
 python/ray/util/dask/tests/test_dask_callback.py   |   13 +-
 .../ray/util/dask/tests/test_dask_optimization.py  |   30 +-
 python/ray/util/dask/tests/test_dask_scheduler.py  |   23 +-
 python/ray/util/data/__init__.py                   |   25 +-
 python/ray/util/data/dataset.py                    |  212 +-
 python/ray/util/data/examples/mlp_identity_tf.py   |   18 +-
 .../ray/util/data/examples/mlp_identity_torch.py   |   15 +-
 python/ray/util/data/parquet.py                    |   59 +-
 python/ray/util/horovod/horovod_example.py         |  122 +-
 python/ray/util/horovod/tests/test_horovod.py      |   13 +-
 python/ray/util/inspect.py                         |    5 +-
 python/ray/util/iter.py                            |  268 +--
 python/ray/util/iter_metrics.py                    |    6 +-
 python/ray/util/joblib/__init__.py                 |   13 +-
 python/ray/util/joblib/ray_backend.py              |   19 +-
 python/ray/util/lightgbm/__init__.py               |   23 +-
 python/ray/util/lightgbm/release_test_util.py      |   75 +-
 python/ray/util/lightgbm/simple_example.py         |   13 +-
 python/ray/util/lightgbm/simple_tune.py            |   17 +-
 python/ray/util/lightgbm/tests/test_client.py      |    3 +
 python/ray/util/metrics.py                         |  117 +-
 python/ray/util/ml_utils/dict.py                   |   49 +-
 python/ray/util/ml_utils/json.py                   |    3 +-
 python/ray/util/ml_utils/mlflow.py                 |  122 +-
 python/ray/util/ml_utils/tests/test_mlflow.py      |   40 +-
 python/ray/util/multiprocessing/pool.py            |  243 +--
 python/ray/util/placement_group.py                 |  141 +-
 python/ray/util/queue.py                           |   39 +-
 python/ray/util/ray_lightning/__init__.py          |    5 +-
 python/ray/util/ray_lightning/simple_example.py    |   29 +-
 python/ray/util/ray_lightning/simple_tune.py       |   19 +-
 python/ray/util/ray_lightning/tune/__init__.py     |   20 +-
 python/ray/util/rpdb.py                            |   96 +-
 python/ray/util/scheduling_strategies.py           |   23 +-
 python/ray/util/serialization.py                   |    7 +-
 python/ray/util/sgd/__init__.py                    |    6 +-
 python/ray/util/sgd/data/__init__.py               |    1 +
 python/ray/util/sgd/data/dataset.py                |   23 +-
 python/ray/util/sgd/data/examples/mlp_identity.py  |    3 +-
 python/ray/util/sgd/tests/test_client.py           |   23 +-
 python/ray/util/sgd/tests/test_placement_groups.py |   25 +-
 python/ray/util/sgd/tests/test_ptl.py              |   61 +-
 python/ray/util/sgd/tests/test_tensorflow.py       |   42 +-
 python/ray/util/sgd/tests/test_torch.py            |  124 +-
 python/ray/util/sgd/tests/test_torch_2.py          |   88 +-
 python/ray/util/sgd/tests/test_torch_3.py          |   37 +-
 python/ray/util/sgd/tests/test_torch_basic.py      |   31 +-
 python/ray/util/sgd/tests/test_torch_failure.py    |   56 +-
 python/ray/util/sgd/tests/test_torch_runner.py     |   48 +-
 python/ray/util/sgd/tf/__init__.py                 |    2 +-
 .../ray/util/sgd/tf/examples/cifar_tf_example.py   |   74 +-
 .../sgd/tf/examples/tensorflow_train_example.py    |   55 +-
 python/ray/util/sgd/tf/tf_dataset.py               |   70 +-
 python/ray/util/sgd/tf/tf_runner.py                |   21 +-
 python/ray/util/sgd/tf/tf_trainer.py               |   55 +-
 python/ray/util/sgd/torch/__init__.py              |   13 +-
 python/ray/util/sgd/torch/constants.py             |    7 +-
 .../ray/util/sgd/torch/distributed_torch_runner.py |   57 +-
 .../sgd/torch/examples/benchmarks/benchmark.py     |   55 +-
 .../sgd/torch/examples/benchmarks/dp_benchmark.py  |   39 +-
 .../examples/benchmarks/horovod_benchmark_apex.py  |   45 +-
 .../sgd/torch/examples/cifar_pytorch_example.py    |  112 +-
 .../util/sgd/torch/examples/cifar_pytorch_pbt.py   |  109 +-
 python/ray/util/sgd/torch/examples/dcgan.py        |  117 +-
 .../util/sgd/torch/examples/deep_graph/gat_dgl.py  |  178 +-
 .../util/sgd/torch/examples/image_models/args.py   |  260 ++-
 .../util/sgd/torch/examples/image_models/train.py  |   33 +-
 .../util/sgd/torch/examples/image_models/util.py   |    3 +-
 .../torch/examples/pytorch-lightning/mnist-ptl.py  |   59 +-
 .../sgd/torch/examples/segmentation/coco_utils.py  |   43 +-
 .../examples/segmentation/train_segmentation.py    |   95 +-
 .../util/sgd/torch/examples/segmentation/utils.py  |   25 +-
 .../examples/transformers/transformers_example.py  |  208 +-
 .../util/sgd/torch/examples/transformers/utils.py  |  120 +-
 python/ray/util/sgd/torch/lightning_operator.py    |  201 +-
 python/ray/util/sgd/torch/resnet.py                |   35 +-
 python/ray/util/sgd/torch/torch_dataset.py         |   82 +-
 python/ray/util/sgd/torch/torch_runner.py          |   70 +-
 python/ray/util/sgd/torch/torch_trainer.py         |  291 +--
 python/ray/util/sgd/torch/training_operator.py     |  339 ++--
 python/ray/util/sgd/torch/utils.py                 |   19 +-
 python/ray/util/sgd/torch/worker_group.py          |  146 +-
 python/ray/util/sgd/utils.py                       |    2 +-
 python/ray/util/tracing/setup_local_tmp_tracing.py |    4 +-
 python/ray/util/tracing/setup_tempo_tracing.py     |   11 +-
 python/ray/util/tracing/tracing_helper.py          |  192 +-
 python/ray/util/xgboost/__init__.py                |   34 +-
 python/ray/util/xgboost/release_test_util.py       |   71 +-
 python/ray/util/xgboost/simple_example.py          |    9 +-
 python/ray/util/xgboost/simple_tune.py             |   20 +-
 python/ray/util/xgboost/tests/test_client.py       |    3 +
 python/ray/utils.py                                |    6 +-
 python/ray/worker.py                               |  797 +++++---
 python/ray/workers/default_worker.py               |   98 +-
 python/ray/workers/setup_worker.py                 |   16 +-
 python/ray/workflow/__init__.py                    |   18 +-
 python/ray/workflow/api.py                         |  128 +-
 python/ray/workflow/common.py                      |  101 +-
 python/ray/workflow/event_listener.py              |    4 +-
 .../comparisons/cadence/trip_booking_workflow.py   |   24 +-
 .../comparisons/prefect/compute_fib_workflow.py    |    5 +-
 python/ray/workflow/examples/function_chain.py     |   35 +-
 python/ray/workflow/execution.py                   |   81 +-
 python/ray/workflow/recovery.py                    |   77 +-
 python/ray/workflow/serialization.py               |   82 +-
 python/ray/workflow/serialization_context.py       |   22 +-
 python/ray/workflow/step_executor.py               |  242 ++-
 python/ray/workflow/step_function.py               |   71 +-
 python/ray/workflow/storage/__init__.py            |   28 +-
 python/ray/workflow/storage/debug.py               |   28 +-
 python/ray/workflow/storage/filesystem.py          |    7 +-
 python/ray/workflow/storage/s3.py                  |   73 +-
 python/ray/workflow/tests/conftest.py              |   28 +-
 python/ray/workflow/tests/mock_server.py           |   21 +-
 python/ray/workflow/tests/test_basic_workflows.py  |   23 +-
 .../ray/workflow/tests/test_basic_workflows_2.py   |   48 +-
 python/ray/workflow/tests/test_dataset.py          |    1 +
 .../workflow/tests/test_dynamic_workflow_ref.py    |    1 +
 python/ray/workflow/tests/test_events.py           |   92 +-
 .../ray/workflow/tests/test_inplace_workflows.py   |   12 +-
 .../ray/workflow/tests/test_large_intermediate.py  |    3 +-
 python/ray/workflow/tests/test_lifetime.py         |    7 +-
 python/ray/workflow/tests/test_metadata.py         |  117 +-
 python/ray/workflow/tests/test_object_deref.py     |   17 +-
 python/ray/workflow/tests/test_recovery.py         |   46 +-
 python/ray/workflow/tests/test_serialization.py    |   11 +-
 python/ray/workflow/tests/test_signature_check.py  |    1 +
 python/ray/workflow/tests/test_storage.py          |  108 +-
 python/ray/workflow/tests/test_storage_failure.py  |   12 +-
 python/ray/workflow/tests/test_variable_mutable.py |    1 +
 python/ray/workflow/tests/test_virtual_actor.py    |  125 +-
 python/ray/workflow/tests/test_virtual_actor_2.py  |   85 +-
 python/ray/workflow/tests/test_virtual_actor_3.py  |   12 +-
 python/ray/workflow/tests/test_wait.py             |   65 +-
 python/ray/workflow/tests/test_workflow_manager.py |   31 +-
 python/ray/workflow/virtual_actor_class.py         |  200 +-
 python/ray/workflow/workflow_access.py             |  137 +-
 python/ray/workflow/workflow_context.py            |   43 +-
 python/ray/workflow/workflow_storage.py            |  214 +-
 python/setup.py                                    |  151 +-
 release/.buildkite/build_pipeline.py               |  296 +--
 release/alert.py                                   |  248 ++-
 release/alerts/default.py                          |   14 +-
 release/alerts/long_running_tests.py               |   34 +-
 release/alerts/rllib_tests.py                      |   14 +-
 release/alerts/tune_tests.py                       |   32 +-
 release/alerts/xgboost_tests.py                    |   36 +-
 release/e2e.py                                     | 1032 +++++-----
 .../workloads/dask_xgboost_test.py                 |    6 +-
 .../workloads/modin_xgboost_test.py                |    8 +-
 .../workloads/torch_tune_serve_test.py             |   91 +-
 release/golden_notebook_tests/workloads/util.py    |   29 +-
 release/horovod_tests/wait_cluster.py              |   28 +-
 .../horovod_tests/workloads/horovod_tune_test.py   |   57 +-
 release/lightgbm_tests/create_test_data.py         |   36 +-
 release/lightgbm_tests/wait_cluster.py             |   28 +-
 .../workloads/distributed_api_test.py              |    1 +
 .../workloads/ft_small_non_elastic.py              |   20 +-
 release/lightgbm_tests/workloads/train_moderate.py |    6 +-
 release/lightgbm_tests/workloads/train_small.py    |    9 +-
 .../workloads/train_small_connect.py               |    6 +-
 release/lightgbm_tests/workloads/tune_32x4.py      |   14 +-
 release/lightgbm_tests/workloads/tune_4x32.py      |   14 +-
 release/lightgbm_tests/workloads/tune_small.py     |   14 +-
 .../workloads/pytorch_pbt_failure.py               |   62 +-
 release/long_running_tests/wait_cluster.py         |   28 +-
 .../long_running_tests/workloads/actor_deaths.py   |   64 +-
 release/long_running_tests/workloads/apex.py       |   19 +-
 release/long_running_tests/workloads/impala.py     |   19 +-
 .../workloads/many_actor_tasks.py                  |   52 +-
 .../long_running_tests/workloads/many_drivers.py   |   66 +-
 release/long_running_tests/workloads/many_ppo.py   |   19 +-
 release/long_running_tests/workloads/many_tasks.py |   55 +-
 .../workloads/many_tasks_serialized_ids.py         |   55 +-
 .../long_running_tests/workloads/node_failures.py  |   52 +-
 release/long_running_tests/workloads/pbt.py        |   25 +-
 release/long_running_tests/workloads/serve.py      |    9 +-
 .../long_running_tests/workloads/serve_failure.py  |   40 +-
 release/microbenchmark/run_microbenchmark.py       |    7 +-
 release/ml_user_tests/horovod/horovod_user_test.py |    6 +-
 .../ray-lightning/ray_lightning_user_test.py       |    5 +-
 .../train/train_tensorflow_mnist_test.py           |    5 +-
 .../ml_user_tests/train/train_torch_linear_test.py |    5 +-
 .../ml_user_tests/tune_rllib/run_connect_tests.py  |    8 +-
 release/ml_user_tests/xgboost/train_gpu_connect.py |    6 +-
 .../nightly_tests/chaos_test/test_chaos_basic.py   |   50 +-
 .../nightly_tests/dask_on_ray/dask_on_ray_sort.py  |   82 +-
 .../nightly_tests/dask_on_ray/large_scale_test.py  |  143 +-
 .../dataset/dataset_shuffle_data_loader.py         |   28 +-
 release/nightly_tests/dataset/inference.py         |   28 +-
 .../nightly_tests/dataset/pipelined_training.py    |   83 +-
 release/nightly_tests/dataset/ray_sgd_runner.py    |   65 +-
 release/nightly_tests/dataset/ray_sgd_training.py  |  241 ++-
 release/nightly_tests/dataset/wait_cluster.py      |   28 +-
 .../nightly_tests/decision_tree/cart_with_tree.py  |   77 +-
 .../nightly_tests/many_nodes_tests/actor_test.py   |   15 +-
 .../long_running_performance_test.py               |   57 +-
 .../nightly_tests/placement_group_tests/pg_run.py  |    3 +-
 .../placement_group_performance_test.py            |   96 +-
 release/nightly_tests/setup_chaos.py               |   18 +-
 release/nightly_tests/shuffle/shuffle_test.py      |   17 +-
 .../nightly_tests/shuffle_data_loader/benchmark.py |  234 ++-
 .../nightly_tests/stress_tests/test_dead_actors.py |   25 +-
 .../nightly_tests/stress_tests/test_many_tasks.py  |   29 +-
 .../stress_tests/test_placement_group.py           |   36 +-
 .../stress_tests/test_threaded_actors.py           |   19 +-
 release/nightly_tests/wait_cluster.py              |   28 +-
 release/rllib_tests/learning_tests/run.py          |   11 +-
 .../rllib_tests/multi_gpu_learning_tests/run.py    |    6 +-
 .../multi_gpu_with_attention_learning_tests/run.py |    7 +-
 .../multi_gpu_with_lstm_learning_tests/run.py      |    7 +-
 release/rllib_tests/performance_tests/run.py       |    8 +-
 .../rllib_tests/stress_tests/run_stress_tests.py   |   11 +-
 release/rllib_tests/wait_cluster.py                |   28 +-
 release/runtime_env_tests/wait_cluster.py          |   28 +-
 .../workloads/rte_many_tasks_actors.py             |   83 +-
 .../runtime_env_tests/workloads/rte_ray_client.py  |   16 +-
 release/runtime_env_tests/workloads/wheel_urls.py  |   19 +-
 .../workloads/autoscaling_multi_deployment.py      |   69 +-
 .../workloads/autoscaling_single_deployment.py     |   45 +-
 .../workloads/multi_deployment_1k_noop_replica.py  |   46 +-
 .../workloads/serve_cluster_fault_tolerance.py     |   28 +-
 .../workloads/serve_cluster_fault_tolerance_gcs.py |   27 +-
 .../serve_tests/workloads/serve_micro_benchmark.py |    6 +-
 .../workloads/serve_test_cluster_utils.py          |   31 +-
 release/serve_tests/workloads/serve_test_utils.py  |  122 +-
 .../workloads/single_deployment_1k_noop_replica.py |   27 +-
 release/sgd_tests/sgd_gpu/sgd_gpu_test.py          |   14 +-
 release/sgd_tests/wait_cluster.py                  |   28 +-
 release/tune_tests/cloud_tests/wait_cluster.py     |   28 +-
 .../cloud_tests/workloads/_tune_script.py          |   32 +-
 .../cloud_tests/workloads/run_cloud_test.py        |  538 ++---
 .../scalability_tests/create_test_data.py          |   36 +-
 .../tune_tests/scalability_tests/wait_cluster.py   |   28 +-
 .../workloads/test_bookkeeping_overhead.py         |    3 +-
 .../workloads/test_durable_trainable.py            |   23 +-
 .../test_long_running_large_checkpoints.py         |    8 +-
 .../workloads/test_network_overhead.py             |    6 +-
 .../workloads/test_result_throughput_cluster.py    |    3 +-
 .../test_result_throughput_single_node.py          |    3 +-
 .../workloads/test_xgboost_sweep.py                |   47 +-
 release/util/get_contributors.py                   |   29 +-
 release/util/microbenchmark_analysis.py            |   11 +-
 release/util/sanity_check.py                       |   16 +-
 release/util/wait_cluster.py                       |   28 +-
 release/xgboost_tests/create_test_data.py          |   36 +-
 release/xgboost_tests/wait_cluster.py              |   28 +-
 .../workloads/distributed_api_test.py              |    1 +
 .../xgboost_tests/workloads/ft_small_elastic.py    |   33 +-
 .../workloads/ft_small_non_elastic.py              |   25 +-
 release/xgboost_tests/workloads/train_gpu.py       |    6 +-
 release/xgboost_tests/workloads/train_moderate.py  |    6 +-
 release/xgboost_tests/workloads/train_small.py     |    9 +-
 release/xgboost_tests/workloads/tune_32x4.py       |   14 +-
 release/xgboost_tests/workloads/tune_4x32.py       |   14 +-
 release/xgboost_tests/workloads/tune_small.py      |   14 +-
 rllib/__init__.py                                  |   13 +-
 rllib/agents/__init__.py                           |    7 +-
 rllib/agents/a3c/a2c.py                            |   41 +-
 rllib/agents/a3c/a3c.py                            |   17 +-
 rllib/agents/a3c/a3c_tf_policy.py                  |  131 +-
 rllib/agents/a3c/a3c_torch_policy.py               |  109 +-
 rllib/agents/a3c/tests/test_a2c.py                 |    8 +-
 rllib/agents/a3c/tests/test_a3c.py                 |   19 +-
 rllib/agents/ars/ars.py                            |  122 +-
 rllib/agents/ars/ars_tf_policy.py                  |   46 +-
 rllib/agents/ars/ars_torch_policy.py               |   10 +-
 rllib/agents/ars/tests/test_ars.py                 |    4 +-
 rllib/agents/bandit/bandit.py                      |   20 +-
 rllib/agents/bandit/bandit_torch_model.py          |  109 +-
 rllib/agents/bandit/bandit_torch_policy.py         |   55 +-
 rllib/agents/bandit/tests/test_bandits.py          |   36 +-
 .../bandit/tests/tune_LinTS_train_wheel_env.py     |    8 +-
 .../tests/tune_LinUCB_train_recommendation.py      |   18 +-
 rllib/agents/callbacks.py                          |  325 +--
 rllib/agents/cql/cql.py                            |   65 +-
 rllib/agents/cql/cql_tf_policy.py                  |  224 ++-
 rllib/agents/cql/cql_torch_policy.py               |  202 +-
 rllib/agents/cql/tests/test_cql.py                 |   32 +-
 rllib/agents/ddpg/apex.py                          |   14 +-
 rllib/agents/ddpg/ddpg.py                          |   18 +-
 rllib/agents/ddpg/ddpg_tf_model.py                 |  113 +-
 rllib/agents/ddpg/ddpg_tf_policy.py                |  293 +--
 rllib/agents/ddpg/ddpg_torch_model.py              |   98 +-
 rllib/agents/ddpg/ddpg_torch_policy.py             |  170 +-
 rllib/agents/ddpg/td3.py                           |    9 +-
 rllib/agents/ddpg/tests/test_apex_ddpg.py          |   20 +-
 rllib/agents/ddpg/tests/test_ddpg.py               |  306 +--
 rllib/agents/ddpg/tests/test_td3.py                |   15 +-
 rllib/agents/dqn/__init__.py                       |    6 +-
 rllib/agents/dqn/apex.py                           |  184 +-
 rllib/agents/dqn/distributional_q_tf_model.py      |  104 +-
 rllib/agents/dqn/dqn.py                            |   79 +-
 rllib/agents/dqn/dqn_tf_policy.py                  |  311 +--
 rllib/agents/dqn/dqn_torch_model.py                |  111 +-
 rllib/agents/dqn/dqn_torch_policy.py               |  314 +--
 rllib/agents/dqn/learner_thread.py                 |   12 +-
 rllib/agents/dqn/r2d2.py                           |   12 +-
 rllib/agents/dqn/r2d2_tf_policy.py                 |  163 +-
 rllib/agents/dqn/r2d2_torch_policy.py              |  146 +-
 rllib/agents/dqn/simple_q.py                       |   64 +-
 rllib/agents/dqn/simple_q_tf_policy.py             |  125 +-
 rllib/agents/dqn/simple_q_torch_policy.py          |   64 +-
 rllib/agents/dqn/tests/test_apex_dqn.py            |   23 +-
 rllib/agents/dqn/tests/test_dqn.py                 |   14 +-
 rllib/agents/dqn/tests/test_r2d2.py                |    8 +-
 rllib/agents/dqn/tests/test_simple_q.py            |   96 +-
 rllib/agents/dreamer/dreamer.py                    |   28 +-
 rllib/agents/dreamer/dreamer_model.py              |  157 +-
 rllib/agents/dreamer/dreamer_torch_policy.py       |   85 +-
 rllib/agents/dreamer/tests/test_dreamer.py         |    3 +-
 rllib/agents/dreamer/utils.py                      |    9 +-
 rllib/agents/es/es.py                              |  138 +-
 rllib/agents/es/es_tf_policy.py                    |   81 +-
 rllib/agents/es/es_torch_policy.py                 |   70 +-
 rllib/agents/es/optimizers.py                      |   10 +-
 rllib/agents/es/tests/test_es.py                   |    4 +-
 rllib/agents/es/utils.py                           |    8 +-
 rllib/agents/impala/impala.py                      |  190 +-
 rllib/agents/impala/tests/test_impala.py           |   24 +-
 rllib/agents/impala/tests/test_vtrace.py           |  185 +-
 rllib/agents/impala/vtrace_tf.py                   |  428 ++--
 rllib/agents/impala/vtrace_tf_policy.py            |  142 +-
 rllib/agents/impala/vtrace_torch.py                |  142 +-
 rllib/agents/impala/vtrace_torch_policy.py         |  137 +-
 rllib/agents/maml/maml.py                          |   49 +-
 rllib/agents/maml/maml_tf_policy.py                |  238 ++-
 rllib/agents/maml/maml_torch_policy.py             |  229 ++-
 rllib/agents/maml/tests/test_maml.py               |   15 +-
 rllib/agents/marwil/bc.py                          |    9 +-
 rllib/agents/marwil/marwil.py                      |   42 +-
 rllib/agents/marwil/marwil_tf_policy.py            |  100 +-
 rllib/agents/marwil/marwil_torch_policy.py         |   38 +-
 rllib/agents/marwil/tests/test_bc.py               |   20 +-
 rllib/agents/marwil/tests/test_marwil.py           |   54 +-
 rllib/agents/mbmpo/mbmpo.py                        |  109 +-
 rllib/agents/mbmpo/mbmpo_torch_policy.py           |   50 +-
 rllib/agents/mbmpo/model_ensemble.py               |  128 +-
 rllib/agents/mbmpo/tests/test_mbmpo.py             |   15 +-
 rllib/agents/mbmpo/utils.py                        |   45 +-
 rllib/agents/mock.py                               |   76 +-
 rllib/agents/pg/pg.py                              |    3 +-
 rllib/agents/pg/pg_tf_policy.py                    |   18 +-
 rllib/agents/pg/pg_torch_policy.py                 |   17 +-
 rllib/agents/pg/tests/test_pg.py                   |  117 +-
 rllib/agents/pg/utils.py                           |   12 +-
 rllib/agents/ppo/appo.py                           |   28 +-
 rllib/agents/ppo/appo_tf_policy.py                 |  201 +-
 rllib/agents/ppo/appo_torch_policy.py              |  189 +-
 rllib/agents/ppo/ddppo.py                          |  123 +-
 rllib/agents/ppo/ppo.py                            |  137 +-
 rllib/agents/ppo/ppo_tf_policy.py                  |  156 +-
 rllib/agents/ppo/ppo_torch_policy.py               |  137 +-
 rllib/agents/ppo/tests/test_appo.py                |   16 +-
 rllib/agents/ppo/tests/test_ddppo.py               |   26 +-
 rllib/agents/ppo/tests/test_ppo.py                 |  225 ++-
 rllib/agents/qmix/mixers.py                        |    9 +-
 rllib/agents/qmix/model.py                         |   11 +-
 rllib/agents/qmix/qmix.py                          |   49 +-
 rllib/agents/qmix/qmix_policy.py                   |  379 ++--
 rllib/agents/qmix/tests/test_qmix.py               |   62 +-
 rllib/agents/registry.py                           |   42 +-
 rllib/agents/sac/__init__.py                       |   15 +-
 rllib/agents/sac/rnnsac.py                         |   15 +-
 rllib/agents/sac/rnnsac_torch_model.py             |  140 +-
 rllib/agents/sac/rnnsac_torch_policy.py            |  230 ++-
 rllib/agents/sac/sac.py                            |   21 +-
 rllib/agents/sac/sac_tf_model.py                   |   93 +-
 rllib/agents/sac/sac_tf_policy.py                  |  382 ++--
 rllib/agents/sac/sac_torch_model.py                |  131 +-
 rllib/agents/sac/sac_torch_policy.py               |  232 ++-
 rllib/agents/sac/tests/test_rnnsac.py              |    4 +-
 rllib/agents/sac/tests/test_sac.py                 |  376 ++--
 rllib/agents/slateq/slateq.py                      |   37 +-
 rllib/agents/slateq/slateq_torch_policy.py         |  155 +-
 rllib/agents/tests/test_trainer.py                 |  133 +-
 rllib/agents/trainer.py                            | 1037 ++++++----
 rllib/agents/trainer_template.py                   |   86 +-
 rllib/contrib/alpha_zero/core/alpha_zero_policy.py |  101 +-
 .../contrib/alpha_zero/core/alpha_zero_trainer.py  |   77 +-
 rllib/contrib/alpha_zero/core/mcts.py              |   31 +-
 rllib/contrib/alpha_zero/core/ranked_rewards.py    |    5 +-
 rllib/contrib/alpha_zero/environments/cartpole.py  |   22 +-
 .../alpha_zero/models/custom_torch_models.py       |   52 +-
 rllib/contrib/bandits/__init__.py                  |    3 +-
 rllib/contrib/maddpg/maddpg.py                     |   14 +-
 rllib/contrib/maddpg/maddpg_policy.py              |  223 ++-
 rllib/contrib/registry.py                          |    9 +-
 rllib/contrib/sumo/connector.py                    |   89 +-
 rllib/contrib/sumo/utils.py                        |   65 +-
 rllib/env/base_env.py                              |  198 +-
 rllib/env/env_context.py                           |   36 +-
 rllib/env/external_env.py                          |  177 +-
 rllib/env/external_multi_agent_env.py              |   72 +-
 rllib/env/multi_agent_env.py                       |  200 +-
 rllib/env/policy_client.py                         |  198 +-
 rllib/env/policy_server_input.py                   |   66 +-
 rllib/env/remote_base_env.py                       |   42 +-
 rllib/env/remote_vector_env.py                     |    3 +-
 rllib/env/tests/test_multi_agent_env.py            |   34 +-
 rllib/env/tests/test_record_env_wrapper.py         |   10 +-
 rllib/env/tests/test_remote_worker_envs.py         |   12 +-
 rllib/env/utils.py                                 |   14 +-
 rllib/env/vector_env.py                            |  172 +-
 rllib/env/wrappers/atari_wrappers.py               |   31 +-
 rllib/env/wrappers/dm_control_wrapper.py           |   79 +-
 rllib/env/wrappers/dm_env_wrapper.py               |   39 +-
 rllib/env/wrappers/exception_wrapper.py            |    3 +-
 rllib/env/wrappers/group_agents_wrapper.py         |   23 +-
 rllib/env/wrappers/kaggle_wrapper.py               |   98 +-
 rllib/env/wrappers/model_vector_env.py             |   45 +-
 rllib/env/wrappers/open_spiel.py                   |   20 +-
 rllib/env/wrappers/pettingzoo_env.py               |   49 +-
 rllib/env/wrappers/recsim.py                       |   49 +-
 rllib/env/wrappers/recsim_wrapper.py               |   12 +-
 rllib/env/wrappers/tests/test_exception_wrapper.py |   12 +-
 .../wrappers/tests/test_group_agents_wrapper.py    |   17 +-
 rllib/env/wrappers/tests/test_kaggle_wrapper.py    |   25 +-
 rllib/env/wrappers/tests/test_recsim_wrapper.py    |   17 +-
 rllib/env/wrappers/tests/test_unity3d_env.py       |    9 +-
 rllib/env/wrappers/uncertainty_wrappers.py         |   11 +-
 rllib/env/wrappers/unity3d_env.py                  |  148 +-
 rllib/evaluate.py                                  |  188 +-
 rllib/evaluation/__init__.py                       |    4 +-
 rllib/evaluation/collectors/sample_collector.py    |    3 +-
 .../evaluation/collectors/simple_list_collector.py |  443 ++--
 rllib/evaluation/episode.py                        |  116 +-
 rllib/evaluation/metrics.py                        |   64 +-
 rllib/evaluation/observation_function.py           |   13 +-
 rllib/evaluation/postprocessing.py                 |   96 +-
 rllib/evaluation/rollout_worker.py                 |  748 ++++---
 rllib/evaluation/sample_batch_builder.py           |   72 +-
 rllib/evaluation/sampler.py                        |  623 +++---
 rllib/evaluation/tests/test_episode.py             |   65 +-
 rllib/evaluation/tests/test_postprocessing.py      |  155 +-
 rllib/evaluation/tests/test_rollout_worker.py      |  357 ++--
 rllib/evaluation/tests/test_trajectory_view_api.py |  340 ++--
 rllib/evaluation/worker_set.py                     |  295 +--
 rllib/examples/action_masking.py                   |   52 +-
 rllib/examples/attention_net.py                    |   54 +-
 rllib/examples/attention_net_supervised.py         |   28 +-
 rllib/examples/autoregressive_action_dist.py       |   65 +-
 .../bare_metal_policy_with_custom_view_reqs.py     |   23 +-
 rllib/examples/batch_norm_model.py                 |   47 +-
 rllib/examples/cartpole_lstm.py                    |   33 +-
 rllib/examples/centralized_critic.py               |  183 +-
 rllib/examples/centralized_critic_2.py             |   77 +-
 rllib/examples/checkpoint_by_custom_criteria.py    |   26 +-
 rllib/examples/coin_game_env.py                    |   27 +-
 rllib/examples/complex_struct_space.py             |    9 +-
 ...ompute_adapted_gae_on_postprocess_trajectory.py |   80 +-
 rllib/examples/curriculum_learning.py              |   40 +-
 rllib/examples/custom_env.py                       |   78 +-
 rllib/examples/custom_eval.py                      |   33 +-
 rllib/examples/custom_experiment.py                |    3 +-
 rllib/examples/custom_fast_model.py                |   14 +-
 rllib/examples/custom_input_api.py                 |   17 +-
 rllib/examples/custom_keras_model.py               |   68 +-
 rllib/examples/custom_logger.py                    |   45 +-
 rllib/examples/custom_loss.py                      |    3 +-
 rllib/examples/custom_metrics_and_callbacks.py     |  113 +-
 .../custom_metrics_and_callbacks_legacy.py         |   17 +-
 rllib/examples/custom_model_api.py                 |   23 +-
 rllib/examples/custom_model_loss_and_metrics.py    |   31 +-
 rllib/examples/custom_observation_filters.py       |   10 +-
 rllib/examples/custom_rnn_model.py                 |   33 +-
 rllib/examples/custom_tf_policy.py                 |   11 +-
 rllib/examples/custom_torch_policy.py              |    6 +-
 rllib/examples/custom_train_fn.py                  |    3 +-
 rllib/examples/custom_vector_env.py                |   30 +-
 rllib/examples/deterministic_training.py           |   13 +-
 rllib/examples/dmlab_watermaze.py                  |   21 +-
 rllib/examples/documentation/rllib_in_60s.py       |    2 +-
 .../examples/documentation/rllib_on_ray_readme.py  |    8 +-
 .../documentation/rllib_on_rllib_readme.py         |   17 +-
 rllib/examples/eager_execution.py                  |   28 +-
 rllib/examples/env/action_mask_env.py              |   18 +-
 rllib/examples/env/ant_rand_goal.py                |   47 +-
 rllib/examples/env/bandit_envs_discrete.py         |   66 +-
 .../examples/env/bandit_envs_recommender_system.py |   75 +-
 rllib/examples/env/cartpole_mass.py                |    3 +-
 rllib/examples/env/coin_game_non_vectorized_env.py |   85 +-
 rllib/examples/env/coin_game_vectorized_env.py     |  229 ++-
 rllib/examples/env/curriculum_capable_env.py       |    7 +-
 rllib/examples/env/d4rl_env.py                     |    2 +
 rllib/examples/env/debug_counter_env.py            |   15 +-
 rllib/examples/env/dm_control_suite.py             |  100 +-
 rllib/examples/env/env_using_remote_actor.py       |   26 +-
 rllib/examples/env/env_with_subprocess.py          |    3 +-
 rllib/examples/env/fast_image_env.py               |    3 +-
 rllib/examples/env/halfcheetah_rand_direc.py       |   20 +-
 rllib/examples/env/look_and_push.py                |    5 +-
 .../env/matrix_sequential_social_dilemma.py        |  140 +-
 rllib/examples/env/mbmpo_env.py                    |   22 +-
 rllib/examples/env/mock_env.py                     |   10 +-
 rllib/examples/env/multi_agent.py                  |   22 +-
 .../env/nested_space_repeat_after_me_env.py        |   11 +-
 rllib/examples/env/parametric_actions_cartpole.py  |   53 +-
 rllib/examples/env/pendulum_mass.py                |    2 +-
 rllib/examples/env/random_env.py                   |   44 +-
 .../examples/env/recsim_recommender_system_envs.py |   23 +-
 rllib/examples/env/repeat_after_me_env.py          |    4 +-
 rllib/examples/env/simple_corridor.py              |    2 +-
 rllib/examples/env/simple_rpg.py                   |   19 +-
 rllib/examples/env/stateless_cartpole.py           |    3 +-
 rllib/examples/env/stateless_pendulum.py           |    2 +-
 .../env/tests/test_coin_game_non_vectorized_env.py |  322 +--
 .../env/tests/test_coin_game_vectorized_env.py     |  289 ++-
 .../tests/test_matrix_sequential_social_dilemma.py |   44 +-
 rllib/examples/env/tests/test_wrappers.py          |   14 +-
 rllib/examples/env/transformed_action_space_env.py |   10 +-
 rllib/examples/env/two_step_game.py                |   45 +-
 rllib/examples/env/windy_maze_env.py               |   37 +-
 rllib/examples/env_rendering_and_recording.py      |   18 +-
 rllib/examples/export/cartpole_dqn_export.py       |   16 +-
 rllib/examples/export/onnx_tf.py                   |    8 +-
 rllib/examples/export/onnx_torch.py                |   15 +-
 rllib/examples/fractional_gpus.py                  |   33 +-
 rllib/examples/hierarchical_training.py            |   50 +-
 .../policy_inference_after_training.py             |   24 +-
 ...licy_inference_after_training_with_attention.py |   35 +-
 .../policy_inference_after_training_with_lstm.py   |   37 +-
 .../inference_and_serving/serve_and_rllib.py       |    9 +-
 rllib/examples/iterated_prisoners_dilemma_env.py   |   25 +-
 rllib/examples/lstm_auto_wrapping.py               |   12 +-
 rllib/examples/mobilenet_v2_with_lstm.py           |   25 +-
 rllib/examples/models/action_mask_model.py         |   74 +-
 .../examples/models/autoregressive_action_dist.py  |   17 +-
 .../examples/models/autoregressive_action_model.py |   57 +-
 rllib/examples/models/batch_norm_model.py          |   78 +-
 rllib/examples/models/centralized_critic_models.py |  117 +-
 rllib/examples/models/custom_loss_model.py         |   50 +-
 rllib/examples/models/custom_model_api.py          |   53 +-
 rllib/examples/models/eager_model.py               |   22 +-
 rllib/examples/models/fast_model.py                |   31 +-
 .../models/mobilenet_v2_with_lstm_models.py        |   85 +-
 rllib/examples/models/modelv3.py                   |   31 +-
 rllib/examples/models/neural_computer.py           |   78 +-
 rllib/examples/models/parametric_actions_model.py  |  133 +-
 rllib/examples/models/rnn_model.py                 |   87 +-
 rllib/examples/models/rnn_spy_model.py             |   86 +-
 rllib/examples/models/shared_weights_model.py      |   93 +-
 rllib/examples/models/simple_rpg_model.py          |   20 +-
 .../models/trajectory_view_utilizing_models.py     |   88 +-
 rllib/examples/multi_agent_cartpole.py             |   38 +-
 rllib/examples/multi_agent_custom_policy.py        |   32 +-
 rllib/examples/multi_agent_independent_learning.py |    3 +-
 rllib/examples/multi_agent_parameter_sharing.py    |    9 +-
 rllib/examples/multi_agent_two_trainers.py         |   62 +-
 rllib/examples/nested_action_spaces.py             |   59 +-
 rllib/examples/offline_rl.py                       |   15 +-
 rllib/examples/parallel_evaluation_and_training.py |   75 +-
 rllib/examples/parametric_actions_cartpole.py      |   49 +-
 ..._actions_cartpole_embeddings_learnt_by_model.py |   22 +-
 rllib/examples/partial_gpus.py                     |    5 +-
 .../bare_metal_policy_with_custom_view_reqs.py     |   73 +-
 rllib/examples/policy/episode_env_aware_policy.py  |  102 +-
 rllib/examples/policy/random_policy.py             |   39 +-
 .../examples/policy/rock_paper_scissors_dummies.py |   51 +-
 rllib/examples/preprocessing_disabled.py           |   49 +-
 rllib/examples/random_parametric_agent.py          |   40 +-
 rllib/examples/re3_exploration.py                  |   21 +-
 rllib/examples/recsim_with_slateq.py               |   38 +-
 rllib/examples/remote_base_env_with_custom_api.py  |   39 +-
 ...remote_envs_with_inference_done_on_main_node.py |   38 +-
 .../restore_1_of_n_agents_from_checkpoint.py       |   37 +-
 rllib/examples/rnnsac_stateless_cartpole.py        |   17 +-
 rllib/examples/rock_paper_scissors_multiagent.py   |   65 +-
 rllib/examples/rollout_worker_custom_workflow.py   |   42 +-
 rllib/examples/saving_experiences.py               |    6 +-
 rllib/examples/sb2rllib_rllib_example.py           |    5 +-
 .../self_play_league_based_with_open_spiel.py      |  118 +-
 rllib/examples/self_play_with_open_spiel.py        |   49 +-
 rllib/examples/serving/cartpole_client.py          |   18 +-
 rllib/examples/serving/cartpole_server.py          |   86 +-
 rllib/examples/serving/unity3d_client.py           |   30 +-
 rllib/examples/serving/unity3d_dummy_client.py     |   71 +-
 rllib/examples/serving/unity3d_server.py           |   47 +-
 rllib/examples/simulators/sumo/marlenvironment.py  |  112 +-
 rllib/examples/sumo_env_local.py                   |   56 +-
 rllib/examples/trajectory_view_api.py              |   57 +-
 rllib/examples/tune/framework.py                   |    9 +-
 rllib/examples/two_step_game.py                    |   96 +-
 rllib/examples/two_trainer_workflow.py             |  138 +-
 rllib/examples/unity3d_env_local.py                |   48 +-
 rllib/examples/vizdoom_with_attention_net.py       |   18 +-
 rllib/execution/__init__.py                        |   48 +-
 rllib/execution/buffers/minibatch_buffer.py        |   16 +-
 rllib/execution/buffers/mixin_replay_buffer.py     |   13 +-
 .../execution/buffers/multi_agent_replay_buffer.py |   82 +-
 rllib/execution/buffers/replay_buffer.py           |   78 +-
 rllib/execution/common.py                          |   21 +-
 rllib/execution/concurrency_ops.py                 |   43 +-
 rllib/execution/learner_thread.py                  |   37 +-
 rllib/execution/metric_ops.py                      |   99 +-
 rllib/execution/multi_gpu_learner.py               |    6 +-
 rllib/execution/multi_gpu_learner_thread.py        |   67 +-
 rllib/execution/parallel_requests.py               |   27 +-
 rllib/execution/replay_ops.py                      |   41 +-
 rllib/execution/rollout_ops.py                     |  130 +-
 rllib/execution/segment_tree.py                    |   29 +-
 .../tests/test_mixin_multi_agent_replay_buffer.py  |   38 +-
 .../tests/test_prioritized_replay_buffer.py        |   69 +-
 rllib/execution/tests/test_segment_tree.py         |    1 +
 rllib/execution/train_ops.py                       |  213 +-
 rllib/execution/tree_agg.py                        |   64 +-
 rllib/models/action_dist.py                        |    4 +-
 rllib/models/catalog.py                            |  559 ++++--
 rllib/models/jax/fcnet.py                          |   46 +-
 rllib/models/jax/jax_action_dist.py                |    6 +-
 rllib/models/jax/jax_modelv2.py                    |   14 +-
 rllib/models/jax/misc.py                           |   21 +-
 rllib/models/modelv2.py                            |  130 +-
 rllib/models/preprocessors.py                      |   92 +-
 rllib/models/repeated_values.py                    |    9 +-
 rllib/models/tests/test_attention_nets.py          |   35 +-
 rllib/models/tests/test_conv2d_default_stacks.py   |   20 +-
 rllib/models/tests/test_convtranspose2d_stack.py   |   17 +-
 rllib/models/tests/test_distributions.py           |  329 +--
 rllib/models/tests/test_lstms.py                   |   29 +-
 rllib/models/tests/test_models.py                  |   19 +-
 rllib/models/tests/test_preprocessors.py           |   97 +-
 rllib/models/tf/attention_net.py                   |  493 +++--
 rllib/models/tf/complex_input_net.py               |   93 +-
 rllib/models/tf/fcnet.py                           |  149 +-
 rllib/models/tf/layers/__init__.py                 |   14 +-
 rllib/models/tf/layers/gru_gate.py                 |   23 +-
 rllib/models/tf/layers/multi_head_attention.py     |   10 +-
 rllib/models/tf/layers/noisy_layer.py              |   37 +-
 .../tf/layers/relative_multi_head_attention.py     |   40 +-
 rllib/models/tf/layers/skip_connection.py          |    5 +-
 rllib/models/tf/misc.py                            |   51 +-
 rllib/models/tf/recurrent_net.py                   |  267 +--
 rllib/models/tf/tf_action_dist.py                  |  237 ++-
 rllib/models/tf/tf_modelv2.py                      |   41 +-
 rllib/models/tf/visionnet.py                       |  268 ++-
 rllib/models/torch/attention_net.py                |  193 +-
 rllib/models/torch/complex_input_net.py            |   89 +-
 rllib/models/torch/fcnet.py                        |   70 +-
 rllib/models/torch/misc.py                         |   89 +-
 rllib/models/torch/modules/__init__.py             |   14 +-
 .../models/torch/modules/convtranspose2d_stack.py  |   35 +-
 rllib/models/torch/modules/gru_gate.py             |   25 +-
 rllib/models/torch/modules/multi_head_attention.py |   15 +-
 rllib/models/torch/modules/noisy_layer.py          |   47 +-
 .../torch/modules/relative_multi_head_attention.py |   52 +-
 rllib/models/torch/modules/skip_connection.py      |    7 +-
 rllib/models/torch/recurrent_net.py                |   87 +-
 rllib/models/torch/torch_action_dist.py            |  181 +-
 rllib/models/torch/torch_modelv2.py                |   31 +-
 rllib/models/torch/visionnet.py                    |  114 +-
 rllib/models/utils.py                              |   61 +-
 rllib/offline/d4rl_reader.py                       |    1 +
 rllib/offline/dataset_reader.py                    |    5 +-
 rllib/offline/dataset_writer.py                    |   25 +-
 rllib/offline/input_reader.py                      |   31 +-
 rllib/offline/io_context.py                        |   12 +-
 rllib/offline/is_estimator.py                      |   13 +-
 rllib/offline/json_reader.py                       |  130 +-
 rllib/offline/json_writer.py                       |   37 +-
 rllib/offline/off_policy_estimator.py              |   12 +-
 rllib/offline/wis_estimator.py                     |   13 +-
 rllib/policy/dynamic_tf_policy.py                  |  668 +++---
 rllib/policy/eager_tf_policy.py                    |  448 +++--
 rllib/policy/policy.py                             |  400 ++--
 rllib/policy/policy_map.py                         |   66 +-
 rllib/policy/policy_template.py                    |  209 +-
 rllib/policy/rnn_sequencing.py                     |  167 +-
 rllib/policy/sample_batch.py                       |  281 +--
 rllib/policy/tests/test_compute_log_likelihoods.py |   83 +-
 rllib/policy/tests/test_policy.py                  |    9 +-
 rllib/policy/tests/test_rnn_sequencing.py          |   23 +-
 rllib/policy/tests/test_sample_batch.py            |  295 ++-
 rllib/policy/tf_policy.py                          |  612 +++---
 rllib/policy/tf_policy_template.py                 |  175 +-
 rllib/policy/torch_policy.py                       |  545 ++---
 rllib/policy/torch_policy_template.py              |  125 +-
 rllib/policy/view_requirement.py                   |   25 +-
 rllib/scripts.py                                   |   18 +-
 .../debug_learning_failure_git_bisect.py           |   68 +-
 rllib/tests/mock_worker.py                         |    8 +-
 rllib/tests/run_regression_tests.py                |   42 +-
 rllib/tests/test_catalog.py                        |   58 +-
 rllib/tests/test_checkpoint_restore.py             |   33 +-
 rllib/tests/test_dependency_tf.py                  |   18 +-
 rllib/tests/test_dependency_torch.py               |   13 +-
 rllib/tests/test_dnc.py                            |    4 +-
 rllib/tests/test_eager_support.py                  |   24 +-
 rllib/tests/test_env_with_subprocess.py            |   42 +-
 rllib/tests/test_exec_api.py                       |   16 +-
 rllib/tests/test_execution.py                      |   51 +-
 rllib/tests/test_export.py                         |   29 +-
 rllib/tests/test_external_env.py                   |   58 +-
 rllib/tests/test_external_multi_agent_env.py       |   16 +-
 rllib/tests/test_filters.py                        |   22 +-
 rllib/tests/test_gpus.py                           |   36 +-
 rllib/tests/test_ignore_worker_failure.py          |   19 +-
 rllib/tests/test_io.py                             |  147 +-
 rllib/tests/test_local.py                          |    1 +
 rllib/tests/test_lstm.py                           |  197 +-
 rllib/tests/test_model_imports.py                  |  114 +-
 rllib/tests/test_multi_agent_env.py                |  273 +--
 rllib/tests/test_multi_agent_pendulum.py           |   20 +-
 rllib/tests/test_nested_action_spaces.py           |   62 +-
 rllib/tests/test_nested_observation_spaces.py      |  275 ++-
 rllib/tests/test_nn_framework_import_errors.py     |   11 +-
 rllib/tests/test_perf.py                           |    7 +-
 rllib/tests/test_pettingzoo_env.py                 |   17 +-
 rllib/tests/test_placement_groups.py               |   44 +-
 rllib/tests/test_ray_client.py                     |    6 +-
 rllib/tests/test_reproducibility.py                |    4 +-
 rllib/tests/test_rllib_train_and_evaluate.py       |  130 +-
 rllib/tests/test_supported_multi_agent.py          |   87 +-
 rllib/tests/test_supported_spaces.py               |  101 +-
 rllib/tests/test_timesteps.py                      |    1 +
 rllib/tests/test_vector_env.py                     |    4 +-
 rllib/train.py                                     |   93 +-
 rllib/tuned_examples/cleanup_experiment.py         |   55 +-
 rllib/utils/__init__.py                            |   43 +-
 rllib/utils/actors.py                              |   23 +-
 rllib/utils/annotations.py                         |    3 +-
 rllib/utils/compression.py                         |    9 +-
 rllib/utils/debug.py                               |   28 +-
 rllib/utils/deprecation.py                         |   20 +-
 rllib/utils/error.py                               |    8 +-
 rllib/utils/exploration/__init__.py                |   17 +-
 rllib/utils/exploration/curiosity.py               |  243 ++-
 rllib/utils/exploration/epsilon_greedy.py          |  152 +-
 rllib/utils/exploration/exploration.py             |   76 +-
 rllib/utils/exploration/gaussian_noise.py          |  157 +-
 .../utils/exploration/ornstein_uhlenbeck_noise.py  |  165 +-
 rllib/utils/exploration/parameter_noise.py         |  177 +-
 .../utils/exploration/per_worker_epsilon_greedy.py |   23 +-
 .../utils/exploration/per_worker_gaussian_noise.py |   26 +-
 .../per_worker_ornstein_uhlenbeck_noise.py         |   26 +-
 rllib/utils/exploration/random.py                  |  115 +-
 rllib/utils/exploration/random_encoder.py          |   88 +-
 rllib/utils/exploration/soft_q.py                  |   32 +-
 rllib/utils/exploration/stochastic_sampling.py     |   97 +-
 rllib/utils/exploration/tests/test_curiosity.py    |   59 +-
 rllib/utils/exploration/tests/test_explorations.py |   67 +-
 .../exploration/tests/test_parameter_noise.py      |   29 +-
 .../utils/exploration/tests/test_random_encoder.py |    2 +-
 rllib/utils/exploration/thompson_sampling.py       |   13 +-
 rllib/utils/exploration/upper_confidence_bound.py  |   13 +-
 rllib/utils/filter.py                              |   43 +-
 rllib/utils/filter_manager.py                      |    5 +-
 rllib/utils/framework.py                           |   63 +-
 rllib/utils/from_config.py                         |   62 +-
 rllib/utils/images.py                              |    1 +
 rllib/utils/metrics/learner_info.py                |   27 +-
 rllib/utils/metrics/window_stat.py                 |   18 +-
 rllib/utils/numpy.py                               |  136 +-
 rllib/utils/pre_checks/env.py                      |  242 ++-
 rllib/utils/pre_checks/multi_agent.py              |   58 +-
 rllib/utils/schedules/__init__.py                  |    8 +-
 rllib/utils/schedules/exponential_schedule.py      |   18 +-
 rllib/utils/schedules/piecewise_schedule.py        |   33 +-
 rllib/utils/schedules/polynomial_schedule.py       |   28 +-
 rllib/utils/schedules/schedule.py                  |    3 +-
 rllib/utils/schedules/tests/test_schedules.py      |   49 +-
 rllib/utils/sgd.py                                 |   45 +-
 rllib/utils/spaces/flexdict.py                     |    7 +-
 rllib/utils/spaces/repeated.py                     |    7 +-
 rllib/utils/spaces/simplex.py                      |   14 +-
 rllib/utils/spaces/space_utils.py                  |   69 +-
 rllib/utils/spaces/tests/test_space_utils.py       |   37 +-
 rllib/utils/test_utils.py                          |  379 ++--
 rllib/utils/tests/test_check_env.py                |  169 +-
 rllib/utils/tests/test_check_multi_agent.py        |    5 +-
 rllib/utils/tests/test_errors.py                   |    7 +-
 .../tests/test_framework_agnostic_components.py    |   48 +-
 rllib/utils/tests/test_taskpool.py                 |   39 +-
 rllib/utils/tests/test_utils.py                    |  515 ++++-
 rllib/utils/tf_run_builder.py                      |   36 +-
 rllib/utils/tf_utils.py                            |  122 +-
 rllib/utils/threading.py                           |    3 +-
 rllib/utils/torch_utils.py                         |   95 +-
 rllib/utils/typing.py                              |   17 +-
 1637 files changed, 75458 insertions(+), 59446 deletions(-)
